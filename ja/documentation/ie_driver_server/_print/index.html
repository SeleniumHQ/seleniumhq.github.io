<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=ja class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=canonical type=text/html href=/ja/documentation/ie_driver_server/><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>IE Driver サーバー | Selenium</title><meta name=description content="Internet Explorer Driverは、WebDriverの仕様を実装するスタンドアロンサーバーです。
"><meta property="og:title" content="IE Driver サーバー"><meta property="og:description" content="Internet Explorer Driverは、WebDriverの仕様を実装するスタンドアロンサーバーです。
"><meta property="og:type" content="website"><meta property="og:url" content="/ja/documentation/ie_driver_server/"><meta property="og:image" content="/images/selenium_4_logo.png"><meta property="og:site_name" content="Selenium"><meta itemprop=name content="IE Driver サーバー"><meta itemprop=description content="Internet Explorer Driverは、WebDriverの仕様を実装するスタンドアロンサーバーです。
"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/images/selenium_4_logo.png"><meta name=twitter:title content="IE Driver サーバー"><meta name=twitter:description content="Internet Explorer Driverは、WebDriverの仕様を実装するスタンドアロンサーバーです。
"><link rel=preload href=/scss/main.min.d5ac5f1b576decba108e173dbaf5f52b13fe0b921a41be4ff4e2748ecd784ef1.css as=style><link href=/scss/main.min.d5ac5f1b576decba108e173dbaf5f52b13fe0b921a41be4ff4e2748ecd784ef1.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.3.min.js integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ==" crossorigin=anonymous></script>
<link rel=stylesheet href=/css/prism.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3.5.2 integrity="sha512-TW5eKlwwg7OfQUVBqxjp94/uqtjJJbhkRE3++XGEQjAL1n3y//QVqS3acPkwqkzInaFRtj+w05uyxDbfDXiI1A==" crossorigin=anonymous><script defer data-domain=selenium.dev src=https://plausible.io/js/plausible.js></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand-lg navbar-light bg-white flex-row td-navbar"><a class=navbar-brand href=/ja/><span class=navbar-logo><svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 139.38 34"><defs><style>.cls-1{fill:#43b02a}</style></defs><title>Selenium logo green</title><path class="cls-1" d="M46.2 26.37a18.85 18.85.0 01-2.57-.2 25 25 0 01-2.74-.53v-1.39a25.31 25.31.0 002.71.53 18 18 0 002.5.2 5.51 5.51.0 003.29-.84 2.79 2.79.0 001.14-2.39 2.85 2.85.0 00-1.24-2.49A6 6 0 0048 18.55q-.78-.29-1.67-.55A15.93 15.93.0 0144 17.13a5.92 5.92.0 01-1.58-1.05 3.6 3.6.0 01-.9-1.34A5 5 0 0141.23 13a4.46 4.46.0 01.41-1.93 4.31 4.31.0 011.17-1.5 5.26 5.26.0 011.82-1A8 8 0 0147 8.28a20.51 20.51.0 014.41.57v1.42a20 20 0 00-2.23-.44 15.2 15.2.0 00-2-.15 4.86 4.86.0 00-3.08.9A2.9 2.9.0 0042.88 13a3.25 3.25.0 00.21 1.21 2.61 2.61.0 00.7 1 4.83 4.83.0 001.27.79 14.31 14.31.0 002 .68q1.11.33 2.06.71a6.21 6.21.0 011.65.94 4.09 4.09.0 011.1 1.38 4.54 4.54.0 01.4 2 4.15 4.15.0 01-1.56 3.48A7.16 7.16.0 0146.2 26.37z"/><path class="cls-1" d="M60.62 26.32a5.46 5.46.0 01-4.28-1.62A6.9 6.9.0 0154.88 20a7.8 7.8.0 011.43-5 5 5 0 014.14-1.75 4.24 4.24.0 013.47 1.43A6.48 6.48.0 0165.1 18.8q0 .54.0.92a3.22 3.22.0 01-.09.64H56.44a5.39 5.39.0 001.17 3.5A4.18 4.18.0 0060.8 25a10.52 10.52.0 001.82-.17 11.77 11.77.0 001.93-.52l.12 1.27a10.68 10.68.0 01-2 .55A11.47 11.47.0 0160.62 26.32zM60.4 14.43q-3.68.0-3.94 4.74h7.15a6.49 6.49.0 00-.78-3.63A2.76 2.76.0 0060.4 14.43z"/><path class="cls-1" d="M68.64 7h1.58V26.11H68.64z"/><path class="cls-1" d="M79.56 26.32a5.46 5.46.0 01-4.28-1.62A6.9 6.9.0 0173.83 20a7.8 7.8.0 011.43-5 5 5 0 014.14-1.75 4.24 4.24.0 013.47 1.43A6.48 6.48.0 0184 18.8q0 .54.0.92a3.22 3.22.0 01-.09.64H75.38a5.4 5.4.0 001.17 3.5A4.18 4.18.0 0079.75 25a10.52 10.52.0 001.82-.17 11.8 11.8.0 001.93-.52l.12 1.27a10.68 10.68.0 01-2 .55A11.47 11.47.0 0179.56 26.32zm-.21-11.89q-3.68.0-3.94 4.74h7.15a6.49 6.49.0 00-.78-3.63A2.76 2.76.0 0079.35 14.43z"/><path class="cls-1" d="M87.51 13.37h1.32l.12 1.49h.12q.94-.45 1.72-.78t1.43-.54a8.42 8.42.0 011.2-.31 6.54 6.54.0 011.1-.09A3.3 3.3.0 0197 14a3.63 3.63.0 01.83 2.63v9.51H96.24v-9a3 3 0 00-.55-2 2.18 2.18.0 00-1.69-.6 7.25 7.25.0 00-2.24.41 20.1 20.1.0 00-2.67 1.12v10H87.51z"/><path class="cls-1" d="M102.75 10.52a.93.93.0 01-1.06-1 1.06 1.06.0 012.12.0.93.93.0 01-1.06 1zm-.8 2.85h1.58V26.11h-1.58z"/><path class="cls-1" d="M110.81 26.34q-3.14.0-3.14-3.47v-9.5h1.58v9a3.16 3.16.0 00.48 2 1.92 1.92.0 001.59.6 6.83 6.83.0 002.48-.48q1.25-.48 2.59-1.14V13.37H118V26.11h-1.32l-.12-1.58h-.09l-1.73.81q-.74.34-1.38.57a7.9 7.9.0 01-1.23.33A7.34 7.34.0 01110.81 26.34z"/><path class="cls-1" d="M122.18 13.37h1.3l.14 1.49h.09a19.53 19.53.0 012.58-1.31 5.51 5.51.0 012-.41 2.83 2.83.0 013 1.77h.12q.8-.5 1.45-.83a12.61 12.61.0 011.2-.54 6.17 6.17.0 011-.31 5.18 5.18.0 011-.09 3.3 3.3.0 012.45.84 3.63 3.63.0 01.83 2.63v9.51h-1.56v-9a2.9 2.9.0 00-.55-2 2.21 2.21.0 00-1.69-.59 5.14 5.14.0 00-1.78.38A14.45 14.45.0 00131.6 16v10.1H130v-9a2.9 2.9.0 00-.55-2 2.21 2.21.0 00-1.69-.59 5.24 5.24.0 00-1.86.4A14 14 0 00123.76 16V26.11h-1.58z"/><path class="cls-1" d="M21.45 21.51a2.49 2.49.0 00-2.55 2.21.08.08.0 00.08.1h4.95a.08.08.0 00.08-.09 2.41 2.41.0 00-2.56-2.22z"/><path class="cls-1" d="M32.06 4.91 21.56 16.7a.32.32.0 01-.47.0l-5.36-5.53a.32.32.0 010-.4L17.5 8.5a.32.32.0 01.52.0l3 3.32a.32.32.0 00.49.0L29.87.36A.23.23.0 0029.69.0H.25A.25.25.0 000 .25v33.5A.25.25.0 00.25 34h32a.25.25.0 00.25-.25V5.06A.23.23.0 0032.06 4.91zm-23 25.36a8.08 8.08.0 01-5.74-2 .31.31.0 010-.41l1.25-1.75A.31.31.0 015 26a6.15 6.15.0 004.2 1.64c1.64.0 2.44-.76 2.44-1.56.0-2.48-8.08-.78-8.08-6.06.0-2.33 2-4.27 5.32-4.27a7.88 7.88.0 015.25 1.76.31.31.0 010 .43L12.9 19.65a.31.31.0 01-.45.05 6.08 6.08.0 00-3.84-1.32c-1.28.0-2 .57-2 1.41.0 2.23 8.06.74 8.06 6C14.67 28.33 12.84 30.27 9.05 30.27zM26.68 25.4a.27.27.0 01-.28.28H19a.09.09.0 00-.08.1 2.81 2.81.0 003 2.32 4.62 4.62.0 002.56-.84.27.27.0 01.4.06l.9 1.31a.28.28.0 01-.06.37 6.67 6.67.0 01-4.1 1.28 5.28 5.28.0 01-5.57-5.48 5.31 5.31.0 015.4-5.46c3.11.0 5.22 2.33 5.22 5.74z"/></svg></span></a><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#main_navbar aria-controls=main_navbar aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse justify-content-end" id=main_navbar><ul class="navbar-nav mr-4 mb-2 mb-lg-0 ps-4 ps-lg-2"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>About</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a class=dropdown-item href=/ja/about>About Selenium</a>
<a class=dropdown-item href=/ja/project>Structure and Governance</a>
<a class=dropdown-item href=/ja/events>Events</a>
<a class=dropdown-item href=/ja/ecosystem>Ecosystem</a>
<a class=dropdown-item href=/ja/history>History</a>
<a class=dropdown-item href=/ja/getinvolved>Get Involved</a>
<a class=dropdown-item href=/ja/sponsors>Sponsors</a></div></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/ja/downloads><span>Downloads</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/ja/documentation><span>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/ja/projects><span>Projects</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/ja/support><span>Support</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/ja/blog><span>Blog</span></a></li><li class="nav-item dropdown d-none d-lg-block"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>日本語</a><ul class=dropdown-menu><li><a class=dropdown-item href=/documentation/ie_driver_server/>English</a></li><li><a class=dropdown-item href=/pt-br/documentation/ie_driver_server/>Português (Brasileiro)</a></li><li><a class=dropdown-item href=/zh-cn/documentation/ie_driver_server/>中文简体</a></li></ul></div></li></ul><div class=navbar-nav><div class=td-search><div class=td-search--algolia id=docsearch-1></div></div></div></div></nav><section id=announcement-banner class="alert-static g-0 row -bg-selenium-blue"><div class="container g-0" style=padding:10px><div class="row g-0 justify-content-center"><div class="alert alert-selenium-blue col-12 fade show mb-0 p-0 -bg-selenium-blue" role=alert><h4 class="alert-heading text-center m-0">SeleniumConf Chicago 2023 is a wrap!
<a href="https://www.youtube.com/playlist?list=PLRdSclUtJDYXDEsWI0vwBmJxW17NgsaAk" target=_blank aria-pressed=true>Watch the Videos</a></h4></div></div></div></section></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>これは、このセクションの複数ページの印刷可能なビューです。
<a href=# onclick="return print(),!1">印刷するには、ここをクリックしてください</a>.</p><p><a href=/ja/documentation/ie_driver_server/>このページの通常のビューに戻る</a>.</p></div><h1 class=title>IE Driver サーバー</h1><div class=lead>Internet Explorer Driverは、WebDriverの仕様を実装するスタンドアロンサーバーです。</div><ul><li>1: <a href=#pg-b15bb615b8783ef0142b053c9b6e4cc6>Internet Explorer Driver Internals</a></li></ul><div class=content><p>This documentation previously located <a href=https://github.com/SeleniumHQ/selenium/wiki/InternetExplorerDriver-Internals>on the wiki</a></p><p><code>InternetExplorerDriver</code> は、WebDriverのワイヤプロトコルを実装するスタンドアロンサーバーです。
このドライバーは、IE11およびWindows10でテストされています。
古いバージョンのIEおよびWindowsで動作する可能性がありますが、これはサポートされていません。</p><p>ドライバーは、32ビットおよび64ビットバージョンのブラウザーの実行をサポートします。
ブラウザの起動に使用する"ビット数"を決定する方法の選択は、起動するIEDriverServer.exeのバージョンによって異なります。
32ビットバージョンの <code>IEDriverServer.exe</code> を起動すると、32ビットバージョンのIEが起動します。
同様に、64ビットバージョンのIEDriverServer.exeを起動すると、64ビットバージョンのIEが起動します。</p><h2 id=インストール>インストール</h2><p>InternetExplorerDriverを使用する前にインストーラーを実行する必要はありませんが、いくつかの設定が必要になります。
スタンドアロンサーバーの実行可能ファイルは、<a href=https://www.selenium.dev/downloads/>ダウンロード</a> ページからダウンロードして、
<a href=http://en.wikipedia.org/wiki/PATH_(variable)>PATH</a>に配置する必要があります。</p><h2 id=長所>長所</h2><ul><li>実際のブラウザで実行され、JavaScriptをサポートします。</li></ul><h2 id=短所>短所</h2><ul><li>明らかに、InternetExplorerDriverはWindowsでのみ動作します！</li><li>比較的遅い（それでもかなりてきぱきしているが:)</li></ul><h2 id=コマンドラインスイッチ>コマンドラインスイッチ</h2><p>スタンドアロンの実行可能ファイルとして、IEドライバーの動作はさまざまなコマンドライン引数を使用して変更できます。
これらのコマンドライン引数の値を設定するには、使用している言語バインディングのドキュメントを参照する必要があります。
サポートされているコマンドラインスイッチについて、以下の表で説明します。
すべての-<code>&lt;switch></code>、&ndash;<code>&lt;switch></code>、および /<code>&lt;switch></code> がサポートされています。</p><table><thead><tr><th style=text-align:left>Switch</th><th style=text-align:left>意味</th></tr></thead><tbody><tr><td style=text-align:left>&ndash;port=<code>&lt;portNumber></code></td><td style=text-align:left>IEドライバーのHTTPサーバーが言語バインディングからのコマンドをリッスンするポートを指定します。 デフォルトは5555です。</td></tr><tr><td style=text-align:left>&ndash;host=<code>&lt;hostAdapterIPAddress></code></td><td style=text-align:left>IEドライバーのHTTPサーバーが言語バインディングからのコマンドをリッスンするホストアダプターのIPアドレスを指定します。 デフォルトは127.0.0.1です。</td></tr><tr><td style=text-align:left>&ndash;log-level=<code>&lt;logLevel></code></td><td style=text-align:left>ロギングメッセージを出力するレベルを指定します。 有効な値は、FATAL、ERROR、WARN、INFO、DEBUG、およびTRACEです。 デフォルトはFATALです。</td></tr><tr><td style=text-align:left>&ndash;log-file=<code>&lt;logFile></code></td><td style=text-align:left>ログファイルのフルパスとファイル名を指定します。 デフォルトはstdoutです。</td></tr><tr><td style=text-align:left>&ndash;extract-path=<code>&lt;path></code></td><td style=text-align:left>サーバーが使用するサポートファイルの抽出に使用されるディレクトリへのフルパスを指定します。 指定しない場合、デフォルトでTEMPディレクトリになります。</td></tr><tr><td style=text-align:left>&ndash;silent</td><td style=text-align:left>サーバーの起動時に診断出力を抑制します。</td></tr></tbody></table><h2 id=重要なシステムプロパティ>重要なシステムプロパティ</h2><p>次のシステムプロパティ（Javaコードで <code>System.getProperty()</code> を使用して読み取り、 <code>System.setProperty()</code> または &ldquo;<code>-DpropertyName=value</code>&rdquo; コマンドラインフラグを使用して設定）は、 <code>InternetExplorerDriver</code> によって利用されます。</p><table><thead><tr><th style=text-align:left><strong>プロパティ</strong></th><th style=text-align:left><strong>意味</strong></th></tr></thead><tbody><tr><td style=text-align:left><code>webdriver.ie.driver</code></td><td style=text-align:left>IEドライバーバイナリの場所</td></tr><tr><td style=text-align:left><code>webdriver.ie.driver.host</code></td><td style=text-align:left>IEドライバーがリッスンするホストアダプターのIPアドレスを指定します。</td></tr><tr><td style=text-align:left><code>webdriver.ie.driver.loglevel</code></td><td style=text-align:left>ロギングメッセージを出力するレベルを指定します。 有効な値は、FATAL、ERROR、WARN、INFO、DEBUG、およびTRACEです。 デフォルトはFATALです。</td></tr><tr><td style=text-align:left><code>webdriver.ie.driver.logfile</code></td><td style=text-align:left>ログファイルのフルパスとファイル名を指定します。</td></tr><tr><td style=text-align:left><code>webdriver.ie.driver.silent</code></td><td style=text-align:left>IEドライバーの起動時に診断出力を抑制します。</td></tr><tr><td style=text-align:left><code>webdriver.ie.driver.extractpath</code></td><td style=text-align:left>サーバーが使用するサポートファイルの抽出に使用されるディレクトリへのフルパスを指定します。 指定しない場合、デフォルトでTEMPディレクトリになります。</td></tr></tbody></table><h2 id=必要な構成>必要な構成</h2><ul><li><code>IEDriverServer</code> 実行可能ファイルを<a href=https://www.selenium.dev/downloads/>ダウンロード</a>して、<a href=http://en.wikipedia.org/wiki/PATH_(variable)>PATH</a>に配置する必要があります。</li><li>Windows Vista、Windows 7、またはWindows10のIE7以降では、各ゾーンの保護モード設定を同じ値に設定する必要があります。
値は、すべてのゾーンで同じである限り、オンまたはオフにすることができます。
プロテクトモードの設定を行うには、「ツール」メニューから"インターネットオプション&mldr;&ldquo;を選択し、「セキュリティ」タブをクリックします。
ゾーンごとに、&ldquo;保護モードを有効にする"というラベルの付いたタブの下部にチェックボックスがあります。</li><li>さらに、IE 10以降では、&ldquo;拡張保護モード&rdquo; を無効にする必要があります。
このオプションは、「インターネットオプション」ダイアログの「詳細設定」タブにあります。</li><li>ネイティブマウスイベントを正しい座標に設定できるように、ブラウザのズームレベルを100％に設定する必要があります。</li><li>Windows 10の場合は、ディスプレイの設定で"テキスト、アプリ、その他の項目のサイズを変更する"も100％に設定する必要があります。</li><li>IE 11の場合 <em>のみ</em> 、ドライバーが作成したInternet Explorerのインスタンスへの接続を維持できるように、ターゲットコンピューターにレジストリエントリを設定する必要があります。
32ビットWindowsインストールの場合、レジストリエディタで調べる必要のあるキーは <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BFCACHE</code> です。
64ビットWindowsインストールの場合、キーは<code>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BFCACHE</code>です。
<code>FEATURE_BFCACHE</code> サブキーは存在する場合と存在しない場合があり、存在しない場合は作成する必要があることに注意してください。<br><strong>重要：</strong> このキーの中に、値0の <code>iexplore.exe</code> という名前のDWORD値を作成します。</li></ul><h2 id=ネイティブイベントとinternetexplorer>ネイティブイベントとInternetExplorer</h2><p><code>InternetExplorerDriver</code> はWindows専用であるため、いわゆる"ネイティブ"またはOSレベルのイベントを使用して、ブラウザーでマウスとキーボードの操作を実行しようとします。
これは、同じ操作でシミュレートされたJavaScriptイベントを使用するのとは対照的です。
ネイティブイベントを使用する利点は、JavaScriptサンドボックスに依存せず、ブラウザー内での適切なJavaScriptイベントの伝播を保証することです。
ただし、現在、IEブラウザウィンドウにフォーカスがない場合や、要素にカーソルを合わせようとした場合のマウスイベントにはいくつかの問題があります。</p><h3 id=ブラウザフォーカス>ブラウザフォーカス</h3><p>課題は、ウィンドウにフォーカスがない場合、IE自体がIEブラウザウィンドウ（ <code>WM\_MOUSEDOWN</code> および <code>WM\_MOUSEUP</code> ）に送信するWindowsメッセージを完全に尊重していないように見えることです。
具体的には、クリックされている要素はその周りにフォーカスウィンドウを受け取りますが、クリックは要素によって処理されません。
間違いなく、メッセージを送信するべきではありません。
むしろ、 <code>SendInput()</code> APIを使用する必要がありますが、そのAPIでは、ウィンドウにフォーカスを設定する必要があります。
WebDriverプロジェクトには2つの相反する目標があります。</p><p>まず、ユーザーを可能な限りエミュレートするよう努めます。
これは、JavaScriptを使用してイベントをシミュレートするのではなく、ネイティブイベントを使用することを意味します。</p><p>次に、自動化されているブラウザウィンドウのフォーカスを必要としないようにします。
これは、ブラウザウィンドウをフォアグラウンドに強制するだけでは最適ではないことを意味します。</p><p>さらに考慮しないといけないのは、複数のWebDriverインスタンスで実行される複数のIEインスタンスがある可能性です。
つまり、このような"ウィンドウをフォアグラウンドにする"ソリューションは、IEドライバーのC++コード内のある種の同期構造（mutex？）でラップする必要があります。
それでも、たとえば、ドライバーがIEをフォアグラウンドに移動してからネイティブイベントを実行する間に、ユーザーが別のウィンドウをフォアグラウンドに移動した場合、このコードは競合状態の影響を受けます。</p><p>ドライバーの要件と、これら2つの相反する目標に優先順位を付ける方法についての議論が進行中です。
現在の一般的な知恵は、後者よりも前者を優先し、IEドライバーを使用するときにマシンが他のタスクに使用できないことを文書化することです。
ただし、その決定はまだ確定しておらず、それを実装するためのコードはかなり複雑になる可能性があります。</p><h3 id=要素にカーソルを合わせる>要素にカーソルを合わせる</h3><p>要素にカーソルを合わせようとしたときに、物理的なマウスカーソルがIEブラウザーウィンドウの境界内にある場合、ホバーは機能しません。
より具体的には、ホバーはほんの一瞬だけ機能しているように見え、その後、要素は前の状態に戻ります。
これが発生する一般的な理論は、IEがイベントループ中に何らかのヒットテストを実行しているため、物理カーソルがウィンドウの境界内にあるときに物理マウスの位置に応答するというものです。
WebDriver開発チームは、IEのこの動作の回避策を見つけることができませんでした。</p><h3 id=option-要素をクリックするかフォームを送信して-alert><code>&lt;option></code> 要素をクリックするか、フォームを送信して <code>alert()</code></h3><p>IEドライバーがネイティブイベントを使用して要素と対話しない場所は2つあります。
これは、 <code>&lt;select></code> 要素内の <code>&lt;option></code> 要素をクリックする場合です。
通常の状況では、IEドライバーは、要素の位置とサイズに基づいてクリックする場所を計算します。
通常は、JavaScriptの<code>getBoundingClientRect()</code> メソッドによって返されます。
ただし、 <code>&lt;option></code> 要素の場合、 <code>getBoundingClientRect()</code> は、位置とサイズがゼロの長方形を返します。
IEドライバーは、 <code>click()</code> Automation Atomを使用してこの1つのシナリオを処理します。
これは、基本的に要素の <code>.selected</code> プロパティを設定し、JavaScriptでonChangeイベントをシミュレートします。
ただし、これは、 <code>&lt;select></code> 要素のonChangeイベントに <code>alert()</code> 、 <code>confirm()</code> 、または <code>prompt()</code>を呼び出すJavaScriptコードが含まれている場合、モーダルダイアログが手動で閉じられるまでWebElementの <code>click()</code> メソッドの呼び出しがハングすることを意味します。 WebDriverコードのみを使用したこの動作の既知の回避策はありません。</p><p>同様に、WebElementの <code>submit()</code> メソッドを介してHTMLフォームを送信すると、同じ効果が得られるシナリオがいくつかあります。
これは、ドライバーがフォームでJavaScriptの <code>submit()</code> 関数を呼び出し、
JavaScriptの <code>alert()</code> 、 <code>confirm()</code> 、または <code>prompt()</code> 関数を呼び出す onSubmit イベントハンドラーがある場合に発生する可能性があります。</p><p>この制限は、issue 3508（Google Code）として登録されています。</p><h2 id=internetexplorerdriver-の複数のインスタンス><code>InternetExplorerDriver</code> の複数のインスタンス</h2><p><code>IEDriverServer.exe</code> を作成すると、 <code>InternetExplorerDriver</code> の複数のインスタンスを同時に作成して使用できるようになります。
ただし、この機能はほとんどテストされておらず、Cookieやウィンドウフォーカスなどに問題がある可能性があります。
IEドライバーの複数のインスタンスを使用しようとして、そのような問題が発生した場合は、<code>RemoteWebDriver</code> と仮想マシンの使用を検討してください。</p><p>InternetExplorerの複数のインスタンス間で共有されるCookie（および別のセッションアイテム）の問題には、2つの解決策があります。</p><p>1つ目は、InternetExplorerをプライベートモードで起動することです。
その後、InternetExplorerはクリーンなセッションデータで開始され、終了時に変更されたセッションデータを保存しません。
これを行うには、2つの特定の機能をドライバーに渡す必要があります。
つまり、 <code>true</code> 値を持つ <code>ie.forceCreateProcessApi</code> と <code>-private</code> 値を持つ <code>ie.browserCommandLineSwitches</code> です。
InternetExplorer 8以降でのみ機能することに注意してください。
また、Windowsレジストリ <code>HKLM_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main</code> パスには、値が <code>0</code> のキー<code>TabProcGrowth</code> が含まれている必要があります。</p><p>2つ目は、InternetExplorerの起動中にセッションをクリーンアップすることです。
このためには、 <code>true</code> の値を持つ特定の <code>ie.ensureCleanSession</code> capabilityをドライバーに渡す必要があります。
これにより、手動で開始されたものを含め、InternetExplorerの実行中のすべてのインスタンスのキャッシュがクリアされます。</p><h2 id=iedriverserverexe-をリモートで実行する><code>IEDriverServer.exe</code> をリモートで実行する</h2><p><code>IEDriverServer.exe</code> によって起動されたHTTPサーバーは、ローカルマシンからの接続のみを受け入れるようにアクセス制御リストを設定し、リモートマシンからの着信接続を禁止します。
現在、これはソースコードを <code>IEDriverServer.exe</code> に変更せずに変更することはできません。
リモートマシンでInternetExplorerドライバーを実行するには、Javaスタンドアロンリモートサーバーを、言語バインディングに相当するRemoteWebDriverと組み合わせて使用します。</p><h2 id=windowsサービスで-iedriverserverexe-を実行する>Windowsサービスで <code>IEDriverServer.exe</code> を実行する</h2><p>IEDriverServer.exeをWindowsサービスアプリケーションの一部として使用しようとすることは、明示的にサポートされていません。
サービスプロセス、およびそれらによって生成されるプロセスには、通常のユーザーコンテキストで実行されるプロセスとは大きく異なる要件があります。
<code>IEDriverServer.exe</code> は、その環境では明示的にテストされておらず、サービスプロセスでの使用が禁止されていることが文書化されているWindowsAPI呼び出しが含まれています。
サービスプロセスの下で実行しているときにIEドライバーを動作させることは可能かもしれませんが、その環境で問題が発生したユーザーは、独自の解決策を探す必要があります。</p></div></div><div class=td-content style=page-break-before:always><h1 id=pg-b15bb615b8783ef0142b053c9b6e4cc6>1 - Internet Explorer Driver Internals</h1><div class=lead>More detailed information on the IE Driver.</div><h2 id=client-code-into-the-driver>Client Code Into the Driver</h2><p>We use the W3C WebDriver protocol to communicate with a local instance of an HTTP server. This greatly simplifies the implementation of the language-specific code, and minimzes the number of entry points into the C++ DLL that must be called using a native-code interop technology such as <a href=https://jna.dev.java.net/>JNA</a>, <a href=http://docs.python.org/library/ctypes.html>ctypes</a>, <a href=http://msdn.microsoft.com/en-us/library/aa446536.aspx>pinvoke</a> or <a href=http://www.ruby-doc.org/stdlib/libdoc/dl/rdoc/index.html>DL</a>.</p><h3 id=memory-management>Memory Management</h3><p>The IE driver utilizes the Active Template Library (ATL) to take advantage of its implementation of smart pointers to COM objects. This makes reference counting and cleanup of COM objects much easier.</p><h2 id=why-do-we-require-protected-mode-settings-changes>Why Do We Require Protected Mode Settings Changes?</h2><p>IE 7 on Windows Vista introduced the concept of Protected Mode, which allows for some measure of protection to the underlying Windows OS when browsing. The problem is that when you manipulate an instance of IE via COM, and you navigate to a page that would cause a transition into or out of Protected Mode, IE requires that another browser session be created. This will orphan the COM object of the previous session, not allowing you to control it any longer.</p><p>In IE 7, this will usually manifest itself as a new top-level browser window; in IE 8, a new IExplore.exe process will be created, but it will usually (not always!) seamlessly attach it to the existing IE top-level frame window. Any browser automation framework that drives IE externally (as opposed to using a WebBrowser control) will run into these problems.</p><p>In order to work around that problem, we dictate that to work with IE, all zones must have the same Protected Mode setting. As long as it&rsquo;s on for all zones, or off for all zones, we can prevent the transistions to different Protected Mode zones that would invalidate our browser object. It also allows users to continue to run with UAC turned on, and to run securely in the browser if they set Protected Mode &ldquo;on&rdquo; for all zones.</p><p>In earlier releases of the IE driver, if the user&rsquo;s Protected Mode settings were not correctly set, we would launch IE, and the process would simply hang until the HTTP request timed out. This was suboptimal, as it gave no indication what needed to be set. Erring on the side of caution, we do not modify the user&rsquo;s Protected Mode settings. Current versions, however check that the Protected Mode settings are properly set, and will return an error response if they are not.</p><h2 id=keyboard-and-mouse-input>Keyboard and Mouse Input</h2><p>Key files: <a href=https://github.com/SeleniumHQ/selenium/blob/master/cpp/webdriver-interactions/interactions.cpp>interactions.cpp</a></p><p>There are two ways that we could simulate keyboard and mouse input. The first way, which is used in parts of webdriver, is to synthesize events on the DOM. This has a number of drawbacks, since each browser (and version of a browser) has its own unique quirks; to model each of these is a demanding task, and impossible to get completely right (for example, it&rsquo;s hard to tell what <code>window.selection</code> should be and this is a read-only property on some browsers) The alternative approach is to synthesize keyboard and mouse input at the OS level, ideally without stealing focus from the user (who tends to be doing other things on their computer as long-running webdriver tests run)</p><p>The code for doing this is in <a href=https://github.com/SeleniumHQ/selenium/blob/master/cpp/webdriver-interactions/interactions.cpp>interactions.cpp</a> The key thing to note here is that we use PostMessages to push window events on to the message queue of the IE instance. Typing, in particular, is interesting: we only send the &ldquo;keydown&rdquo; and &ldquo;keyup&rdquo; messages. The &ldquo;keypress&rdquo; event is created if necessary by IE&rsquo;s internal event processing. Because the key press event is not always generated (for example, not every character is printable, and if the default event bubbling is cancelled, listeners don&rsquo;t see the key press event) we send a &ldquo;probe&rdquo; event in after the key down. Once we see that this has been processed, we know that the key press event is on the stack of events to be processed, and that it is safe to send the key up event. If this was not done, it is possible for events to fire in the wrong order, which is definitely sub-optimal.</p><h1 id=working-on-the-internetexplorerdriver>Working On the InternetExplorerDriver</h1><p>Currently, there are tests that will run for the InternetExplorerDriver in all languages (Java, C#, Python, and Ruby), so you should be able to test your changes to the native code no matter what language you&rsquo;re comfortable working in from the client side. For working on the C++ code, you&rsquo;ll need Visual Studio 2010 Professional or higher. Unfortunately, the C++ code of the driver uses ATL to ease the pain of working with COM objects, and ATL is not supplied with Visual C++ 2010 Express Edition. If you&rsquo;re using Eclipse, the process for making and testing modifications is:</p><ol><li>Edit the C++ code in VS.</li><li>Build the code to ensure that it compiles</li><li>Do a complete rebuild when you are ready to run a test. This will cause the created DLL to be copied to the right place to allow its use in Eclipse</li><li>Load Eclipse (or some other IDE, such as Idea)</li><li>Edit the <code>SingleTestSuite</code> so that it is <code>usingDriver(IE)</code></li><li>Create a JUnit run configuration that uses the &ldquo;webdriver-internet-explorer&rdquo; project. If you don&rsquo;t do this, the test won&rsquo;t work at all, and there will be a somewhat cryptic error message on the console.</li></ol><p>Once the basic setup is done, you can start working on the code pretty quickly. You can attach to the process you execute your code from using Visual Studio (from the Debug menu, select Attach to Process&mldr;).</p></div></main></div></div><div class="row justify-content-center p-5"><h2 class="selenium text-center">Selenium Level Sponsors</h2></div><div class="row justify-content-around pt-4 pb-5 px-5"><div class="col-lg-3 col-md-6 mb-4 mb-lg-0 align-self-center px-5 py-3"><a href="http://www.browserstack.com/automate/?utm_campaign=open-source-sponsor&utm_source=seleniumorg&utm_medium=referral" class=border-0><img class="w-100 shadow-1-strong rounded selenium-backer-logo" src=/images/sponsors/browserstack.png alt=BrowserStack></a></div><div class="col-lg-3 col-md-6 mb-4 mb-lg-0 align-self-center px-5 py-3"><a href=http://saucelabs.com class=border-0><img class="w-100 shadow-1-strong rounded selenium-backer-logo" src=/images/sponsors/saucelabs.png alt="Sauce Labs"></a></div><div class="col-lg-3 col-md-6 mb-4 mb-lg-0 align-self-center px-5 py-3"><a href=http://bit.ly/36uZ7ad class=border-0><img class="w-100 shadow-1-strong rounded selenium-backer-logo" src=/images/sponsors/Digital.ai.jpg alt=Digital.ai></a></div><div class="col-lg-3 col-md-6 mb-4 mb-lg-0 align-self-center px-5 py-3"><a href=https://applitools.com/ class=border-0><img class="w-100 shadow-1-strong rounded selenium-backer-logo" src=/images/sponsors/applitools.png alt=Applitools></a></div><div class="col-lg-3 col-md-6 mb-4 mb-lg-0 align-self-center px-5 py-3"><a href=https://www.perfecto.io/ class=border-0><img class="w-100 shadow-1-strong rounded selenium-backer-logo" src=/images/sponsors/perfecto-perforce.jpg alt=Perfecto></a></div><div class="col-lg-3 col-md-6 mb-4 mb-lg-0 align-self-center px-5 py-3"><a href="https://www.lambdatest.com/selenium-automation?utm_source=selenium&utm_medium=open-source-sponsor&utm_campaign=nov_14&utm_term=sk&utm_content=web" class=border-0><img class="w-100 shadow-1-strong rounded selenium-backer-logo" src=/images/sponsors/lambda-test.png alt=LambdaTest></a></div><div class="col-lg-3 col-md-6 mb-4 mb-lg-0 align-self-center px-5 py-3"><a href="https://www.subject-7.com/unified-testing/?utm_source=selenium&utm_medium=unifiedtesting&utm_campaign=product" class=border-0><img class="w-100 shadow-1-strong rounded selenium-backer-logo" src=/images/sponsors/subject7_logo.png alt=Subject7></a></div><div class="col-lg-3 col-md-6 mb-4 mb-lg-0 align-self-center px-5 py-3"><a href="https://www.avoautomation.ai/why-avo//?utm_source=SeleniumHQ&utm_medium=listing&utm_campaign=SeleniumHQ" class=border-0><img class="w-100 shadow-1-strong rounded selenium-backer-logo" src=/images/sponsors/Avo_logo.png alt="Avo Automation"></a></div></div><div class="row justify-content-center pt-2 pb-3 -bg-selenium-cyan"><div class="card text-center border-0 bg-transparent py-5"><div class=card-body><h2 class=card-title>Support the Selenium Project</h2><p class=card-text>Want to support the Selenium project? Learn more or view the full list of sponsors.</p><div class=selenium-button-container><a href=/sponsors class="selenium-button selenium-white-cyan text-uppercase fw-bold">Learn more
<i class="ps-3 fas fa-caret-right"></i></a></div></div></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-bs-toggle=tooltip data-bs-placement=top title="User mailing list" aria-label="User mailing list"><a class=text-white target=_blank rel=noopener href=https://groups.google.com/group/selenium-users aria-label="User mailing list"><i class="fas fa-mail-bulk"></i></a></li><li class="list-inline-item mx-2 h3" data-bs-toggle=tooltip data-bs-placement=top title="Selenium in Twitter" aria-label="Selenium in Twitter"><a class=text-white target=_blank rel=noopener href=https://twitter.com/SeleniumHQ aria-label="Selenium in Twitter"><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-bs-toggle=tooltip data-bs-placement=top title="SeleniumConf YouTube Channel" aria-label="SeleniumConf YouTube Channel"><a class=text-white target=_blank rel=noopener href=https://www.youtube.com/channel/UCbDlgX_613xNMrDqCe3QNEw aria-label="SeleniumConf YouTube Channel"><i class="fab fa-youtube"></i></a></li><li class="list-inline-item mx-2 h3" data-bs-toggle=tooltip data-bs-placement=top title="Selenium in Facebook" aria-label="Selenium in Facebook"><a class=text-white target=_blank rel=noopener href=https://www.facebook.com/Selenium2.WebDriver aria-label="Selenium in Facebook"><i class="fab fa-facebook"></i></a></li></ul></div><div class="col-6 col-sm-4 text-end text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-bs-toggle=tooltip data-bs-placement=top title="Software Freedom Conservancy" aria-label="Software Freedom Conservancy"><a class=text-white target=_blank rel=noopener href=mailto:selenium@sfconservancy.org aria-label="Software Freedom Conservancy"><i class="fas fa-envelope-square"></i></a></li><li class="list-inline-item mx-2 h3" data-bs-toggle=tooltip data-bs-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/seleniumhq/selenium aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-bs-toggle=tooltip data-bs-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank rel=noopener href=https://join.slack.com/t/seleniumhq/shared_invite/zt-22b85hmhv-krEcWUFQCOWh8XfQTWOATQ aria-label=Slack><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-bs-toggle=tooltip data-bs-placement=top title=IRC aria-label=IRC><a class=text-white target=_blank rel=noopener href=https://kiwiirc.com/nextclient/irc.libera.chat/#selenium aria-label=IRC><i class="fas fa-comments"></i></a></li><li class="list-inline-item mx-2 h3" data-bs-toggle=tooltip data-bs-placement=top title="Developer mailing list" aria-label="Developer mailing list"><a class=text-white target=_blank rel=noopener href=https://groups.google.com/g/selenium-developers aria-label="Developer mailing list"><i class="fa fa-envelope"></i></a></li></ul><a href=https://www.netlify.com><img style=margin-right:50px src=https://www.netlify.com/v3/img/components/netlify-light.svg alt="Deploys by Netlify"></a></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2023 Software Freedom Conservancy All Rights Reserved</small><p class=mt-2><a href=/ja/documentation/about/>このドキュメントについて</a></p></div></div></div></footer></div><script src=/js/main.min.bfefba6b7ccbf88710915ea7a0df9461124cad8959623d18119929418a2da080.js integrity="sha256-v++6a3zL+IcQkV6noN+UYRJMrYlZYj0YEZkpQYotoIA=" crossorigin=anonymous></script>
<script src=/js/prism.js></script>
<script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3.5.2 integrity="sha512-LzxWPDNELae1RSIsDRSitKYPJpRtjYo22GbOl+d+xLcjKiZQRRdxSTI3cRRHw7O05e0MbIIu33QnU2rt6ymQ6A==" crossorigin=anonymous></script>
<script type=text/javascript>const containers=["#docsearch-0","#docsearch-1"];for(let e of containers)docsearch({container:e,appId:"6IOXA5JK7Z",apiKey:"2b44a1d3530f9951dd6502059058984a",indexName:"selenium"})</script><script src=/js/tabpane-persist.js></script></body></html>