<!doctype html><html lang=zh-cn class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.66.0"><meta name=description content="Documentation for Selenium"><link rel=icon href=https://www.selenium.dev/documentation/images/favicon.png type=image/png><title>操控浏览器 :: Selenium 文档</title><link href=https://www.selenium.dev/documentation/css/nucleus.css?1623682698 rel=stylesheet><link href=https://www.selenium.dev/documentation/css/fontawesome-all.min.css?1623682698 rel=stylesheet><link href=https://www.selenium.dev/documentation/css/hybrid.css?1623682698 rel=stylesheet><link href=https://www.selenium.dev/documentation/css/featherlight.min.css?1623682698 rel=stylesheet><link href=https://www.selenium.dev/documentation/css/perfect-scrollbar.min.css?1623682698 rel=stylesheet><link href=https://www.selenium.dev/documentation/css/auto-complete.css?1623682698 rel=stylesheet><link href=https://www.selenium.dev/documentation/css/atom-one-dark-reasonable.css?1623682698 rel=stylesheet><link href=https://www.selenium.dev/documentation/css/theme.css?1623682698 rel=stylesheet><link href=https://www.selenium.dev/documentation/css/hugo-theme.css?1623682698 rel=stylesheet><link href=https://www.selenium.dev/documentation/css/theme-selenium.css?1623682698 rel=stylesheet><script src=https://www.selenium.dev/documentation/js/jquery-3.3.1.min.js?1623682698></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/zh-cn/webdriver/browser_manipulation/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=https://www.selenium.dev/documentation/><svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 139.38 34"><defs><style>.cls-1{fill:#fff}</style></defs><title>Selenium</title><path class="cls-1" d="M46.2 26.37a18.85 18.85.0 01-2.57-.2 25 25 0 01-2.74-.53v-1.39a25.31 25.31.0 002.71.53 18 18 0 002.5.2 5.51 5.51.0 003.29-.84 2.79 2.79.0 001.14-2.39 2.85 2.85.0 00-1.24-2.49A6 6 0 0048 18.55q-.78-.29-1.67-.55A15.93 15.93.0 0144 17.13a5.92 5.92.0 01-1.58-1.05 3.6 3.6.0 01-.9-1.34A5 5 0 0141.23 13a4.46 4.46.0 01.41-1.93 4.31 4.31.0 011.17-1.5 5.26 5.26.0 011.82-1A8 8 0 0147 8.28a20.51 20.51.0 014.41.57v1.42a20 20 0 00-2.23-.44 15.2 15.2.0 00-2-.15 4.86 4.86.0 00-3.08.9A2.9 2.9.0 0042.88 13a3.25 3.25.0 00.21 1.21 2.61 2.61.0 00.7 1 4.83 4.83.0 001.27.79 14.31 14.31.0 002 .68q1.11.33 2.06.71a6.21 6.21.0 011.65.94 4.09 4.09.0 011.1 1.38 4.54 4.54.0 01.4 2 4.15 4.15.0 01-1.56 3.48A7.16 7.16.0 0146.2 26.37z"/><path class="cls-1" d="M60.62 26.32a5.46 5.46.0 01-4.28-1.62A6.9 6.9.0 0154.88 20a7.8 7.8.0 011.43-5 5 5 0 014.14-1.75 4.24 4.24.0 013.47 1.43A6.48 6.48.0 0165.1 18.8q0 .54.0.92a3.22 3.22.0 01-.09.64H56.44a5.39 5.39.0 001.17 3.5A4.18 4.18.0 0060.8 25a10.52 10.52.0 001.82-.17 11.77 11.77.0 001.93-.52l.12 1.27a10.68 10.68.0 01-2 .55A11.47 11.47.0 0160.62 26.32zM60.4 14.43q-3.68.0-3.94 4.74h7.15a6.49 6.49.0 00-.78-3.63A2.76 2.76.0 0060.4 14.43z"/><path class="cls-1" d="M68.64 7h1.58V26.11H68.64z"/><path class="cls-1" d="M79.56 26.32a5.46 5.46.0 01-4.28-1.62A6.9 6.9.0 0173.83 20a7.8 7.8.0 011.43-5 5 5 0 014.14-1.75 4.24 4.24.0 013.47 1.43A6.48 6.48.0 0184 18.8q0 .54.0.92a3.22 3.22.0 01-.09.64H75.38a5.4 5.4.0 001.17 3.5A4.18 4.18.0 0079.75 25a10.52 10.52.0 001.82-.17 11.8 11.8.0 001.93-.52l.12 1.27a10.68 10.68.0 01-2 .55A11.47 11.47.0 0179.56 26.32zm-.21-11.89q-3.68.0-3.94 4.74h7.15a6.49 6.49.0 00-.78-3.63A2.76 2.76.0 0079.35 14.43z"/><path class="cls-1" d="M87.51 13.37h1.32l.12 1.49h.12q.94-.45 1.72-.78t1.43-.54a8.42 8.42.0 011.2-.31 6.54 6.54.0 011.1-.09A3.3 3.3.0 0197 14a3.63 3.63.0 01.83 2.63v9.51H96.24v-9a3 3 0 00-.55-2 2.18 2.18.0 00-1.69-.6 7.25 7.25.0 00-2.24.41 20.1 20.1.0 00-2.67 1.12v10H87.51z"/><path class="cls-1" d="M102.75 10.52a.93.93.0 01-1.06-1 1.06 1.06.0 012.12.0A.93.93.0 01102.75 10.52zm-.8 2.85h1.58V26.11h-1.58z"/><path class="cls-1" d="M110.81 26.34l-3.14-3.47V13.37h1.58v9a3.16 3.16.0 00.48 2 1.92 1.92.0 001.59.6 6.83 6.83.0 002.48-.48q1.25-.48 2.59-1.14V13.37H118V26.11h-1.32l-.12-1.58h-.09l-1.73.81q-.74.34-1.38.57a7.9 7.9.0 01-1.23.33A7.34 7.34.0 01110.81 26.34z"/><path class="cls-1" d="M122.18 13.37h1.3l.14 1.49h.09a19.53 19.53.0 012.58-1.31 5.51 5.51.0 012-.41 2.83 2.83.0 013 1.77h.12q.8-.5 1.45-.83a12.61 12.61.0 011.2-.54 6.17 6.17.0 011-.31 5.18 5.18.0 011-.09 3.3 3.3.0 012.45.84 3.63 3.63.0 01.83 2.63v9.51h-1.56v-9a2.9 2.9.0 00-.55-2 2.21 2.21.0 00-1.69-.59 5.14 5.14.0 00-1.78.38A14.45 14.45.0 00131.6 16v10.1H130v-9a2.9 2.9.0 00-.55-2 2.21 2.21.0 00-1.69-.59 5.24 5.24.0 00-1.86.4A14 14 0 00123.76 16V26.11h-1.58z"/><path class="cls-1" d="M21.45 21.51a2.49 2.49.0 00-2.55 2.21.08.08.0 00.08.1h4.95a.08.08.0 00.08-.09A2.41 2.41.0 0021.45 21.51z"/><path class="cls-1" d="M32.06 4.91 21.56 16.7a.32.32.0 01-.47.0l-5.36-5.53a.32.32.0 010-.4l1.77-2.27a.32.32.0 01.52.0l3 3.32a.32.32.0 00.49.0L29.87.36A.23.23.0 0029.69.0H.25A.25.25.0 000 .25v33.5A.25.25.0 00.25 34h32a.25.25.0 00.25-.25V5.06A.23.23.0 0032.06 4.91zm-23 25.36a8.08 8.08.0 01-5.74-2 .31.31.0 010-.41l1.25-1.75A.31.31.0 015 26a6.15 6.15.0 004.2 1.64c1.64.0 2.44-.76 2.44-1.56.0-2.48-8.08-.78-8.08-6.06.0-2.33 2-4.27 5.32-4.27a7.88 7.88.0 015.25 1.76.31.31.0 010 .43L12.9 19.65a.31.31.0 01-.45.05 6.08 6.08.0 00-3.84-1.32c-1.28.0-2 .57-2 1.41.0 2.23 8.06.74 8.06 6C14.67 28.33 12.84 30.27 9.05 30.27zM26.68 25.4a.27.27.0 01-.28.28H19a.09.09.0 00-.08.1 2.81 2.81.0 003 2.32 4.62 4.62.0 002.56-.84.27.27.0 01.4.06l.9 1.31a.28.28.0 01-.06.37 6.67 6.67.0 01-4.1 1.28 5.28 5.28.0 01-5.57-5.48 5.31 5.31.0 015.4-5.46c3.11.0 5.22 2.33 5.22 5.74z"/></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=搜索...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=https://www.selenium.dev/documentation/js/lunr.min.js?1623682698></script><script type=text/javascript src=https://www.selenium.dev/documentation/js/auto-complete.js?1623682698></script><script type=text/javascript>var baseurl="https:\/\/www.selenium.dev\/documentation\/zh-cn";</script><script type=text/javascript src=https://www.selenium.dev/documentation/js/search.js?1623682698></script></div><div class=highlightable><ul class=topics><li data-nav-id=/zh-cn/getting_started/ title=入门指南 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/getting_started/>入门指南
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/zh-cn/getting_started/quick/ title=快速浏览 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/getting_started/quick/>快速浏览
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/zh-cn/introduction/ title=介绍 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/introduction/>介绍
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/zh-cn/introduction/the_selenium_project_and_tools/ title="Selenium 项目和工具" class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/introduction/the_selenium_project_and_tools/>Selenium 项目和工具
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/introduction/on_test_automation/ title=关于测试自动化 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/introduction/on_test_automation/>关于测试自动化
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/introduction/types_of_testing/ title=测试的类型 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/introduction/types_of_testing/>测试的类型
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/introduction/about_this_documentation/ title=关于这个文档 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/introduction/about_this_documentation/>关于这个文档
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/zh-cn/selenium_installation/ title="Selenium 安装" class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/selenium_installation/>Selenium 安装
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/zh-cn/selenium_installation/installing_selenium_libraries/ title="安装 Selenium 库" class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/selenium_installation/installing_selenium_libraries/>安装 Selenium 库
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/selenium_installation/installing_webdriver_binaries/ title="安装 WebDriver 二进制文件" class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/selenium_installation/installing_webdriver_binaries/>安装 WebDriver 二进制文件
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/selenium_installation/installing_standalone_server/ title=安装独立服务器 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/selenium_installation/installing_standalone_server/>安装独立服务器
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/zh-cn/getting_started_with_webdriver/ title="WebDriver 入门" class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/getting_started_with_webdriver/>WebDriver 入门
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/zh-cn/getting_started_with_webdriver/browsers/ title=浏览器 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/getting_started_with_webdriver/browsers/>浏览器
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/getting_started_with_webdriver/third_party_drivers_and_plugins/ title=第三方驱动和插件 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/getting_started_with_webdriver/third_party_drivers_and_plugins/>第三方驱动和插件
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/zh-cn/webdriver/ title=WebDriver class="dd-item
parent"><a href=https://www.selenium.dev/documentation/zh-cn/webdriver/>WebDriver
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/zh-cn/webdriver/understanding_the_components/ title=了解组件 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/webdriver/understanding_the_components/>了解组件
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/webdriver/driver_requirements/ title=驱动要求 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/webdriver/driver_requirements/>驱动要求
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/webdriver/bidi_apis/ title="WebDriver Bidi APIs" class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/webdriver/bidi_apis/>WebDriver Bidi APIs
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/webdriver/locating_elements/ title=定位元素 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/webdriver/locating_elements/>定位元素
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/webdriver/browser_manipulation/ title=操控浏览器 class="dd-item active"><a href=https://www.selenium.dev/documentation/zh-cn/webdriver/browser_manipulation/>操控浏览器
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/webdriver/waits/ title=等待 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/webdriver/waits/>等待
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/webdriver/support_classes/ title=支持的类 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/webdriver/support_classes/>支持的类
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/webdriver/js_alerts_prompts_and_confirmations/ title="JavaScript 警告框,提示框和确认框" class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/webdriver/js_alerts_prompts_and_confirmations/>JavaScript 警告框,提示框和确认框
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/webdriver/http_proxies/ title="Http 代理" class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/webdriver/http_proxies/>Http 代理
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/webdriver/page_loading_strategy/ title=页面加载策略 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/webdriver/page_loading_strategy/>页面加载策略
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/webdriver/web_element/ title=网络元素 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/webdriver/web_element/>网络元素
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/webdriver/keyboard/ title=Keyboard class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/webdriver/keyboard/>Keyboard
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/zh-cn/remote_webdriver/ title="远程 WebDriver" class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/remote_webdriver/>远程 WebDriver
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/zh-cn/remote_webdriver/remote_webdriver_client/ title=远程WebDriver客户端 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/remote_webdriver/remote_webdriver_client/>远程WebDriver客户端
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/zh-cn/guidelines_and_recommendations/ title=指南和建议 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/guidelines_and_recommendations/>指南
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/zh-cn/guidelines_and_recommendations/page_object_models/ title=PO设计模式 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/guidelines_and_recommendations/page_object_models/>PO设计模式
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/guidelines_and_recommendations/domain_specific_language/ title=领域特定语言 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/guidelines_and_recommendations/domain_specific_language/>领域特定语言
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/guidelines_and_recommendations/generating_application_state/ title=生成应用程序状态 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/guidelines_and_recommendations/generating_application_state/>生成应用程序状态
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/guidelines_and_recommendations/mock_external_services/ title=模拟外部服务 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/guidelines_and_recommendations/mock_external_services/>模拟外部服务
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/guidelines_and_recommendations/improved_reporting/ title=改善报告 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/guidelines_and_recommendations/improved_reporting/>改善报告
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/guidelines_and_recommendations/avoid_sharing_state/ title=避免共享状态 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/guidelines_and_recommendations/avoid_sharing_state/>避免共享状态
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/guidelines_and_recommendations/test_independency/ title=测试的独立性 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/guidelines_and_recommendations/test_independency/>测试的独立性
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/guidelines_and_recommendations/consider_using_a_fluent_api/ title="考虑使用Fluent API" class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/guidelines_and_recommendations/consider_using_a_fluent_api/>考虑使用Fluent API
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/guidelines_and_recommendations/fresh_browser_per_test/ title=每次测试都刷新浏览器 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/guidelines_and_recommendations/fresh_browser_per_test/>每次测试都刷新浏览器
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/zh-cn/worst_practices/ title=反模式 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/worst_practices/>反模式
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/zh-cn/worst_practices/two_factor_authentication/ title=双因素认证 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/worst_practices/two_factor_authentication/>双因素认证
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/worst_practices/captchas/ title=验证码 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/worst_practices/captchas/>验证码
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/worst_practices/file_downloads/ title=文件下载 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/worst_practices/file_downloads/>文件下载
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/worst_practices/http_response_codes/ title=HTTP响应码 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/worst_practices/http_response_codes/>HTTP响应码
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/worst_practices/gmail_email_and_facebook_logins/ title="Gmail, email 和 Facebook 登录" class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/worst_practices/gmail_email_and_facebook_logins/>Gmail, email and Facebook
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/worst_practices/test_dependency/ title=测试依赖 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/worst_practices/test_dependency/>测试依赖
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/worst_practices/performance_testing/ title=性能测试 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/worst_practices/performance_testing/>性能测试
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/worst_practices/link_spidering/ title=爬取链接 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/worst_practices/link_spidering/>爬取链接
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/zh-cn/grid/ title=服务网格 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/grid/>服务网格
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/zh-cn/grid/purposes_and_main_functionalities/ title=目的和主要功能 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/grid/purposes_and_main_functionalities/>目的和主要功能
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/grid/when_to_use_grid/ title=什么时候应该使用服务网格 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/grid/when_to_use_grid/>什么时候应该使用服务网格
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/grid/grid_3/ title="服务网格 3" class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/grid/grid_3/>服务网格 3
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/zh-cn/grid/grid_3/components_of_a_grid/ title=服务网格的组件 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/grid/grid_3/components_of_a_grid/>服务网格的组件
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/grid/grid_3/setting_up_your_own_grid/ title=配置自己的服务网格 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/grid/grid_3/setting_up_your_own_grid/>配置自己的服务网格
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/zh-cn/grid/grid_4/ title="服务网格 4" class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/grid/grid_4/>服务网格 4
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/zh-cn/grid/grid_4/components_of_a_grid/ title=服务网格的组件 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/grid/grid_4/components_of_a_grid/>服务网格的组件
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/grid/grid_4/setting_up_your_own_grid/ title=配置自己的服务网格 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/grid/grid_4/setting_up_your_own_grid/>配置自己的服务网格
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/grid/grid_4/configuring_components/ title=配置组件 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/grid/grid_4/configuring_components/>配置组件
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/zh-cn/grid/grid_4/configuring_components/config_help/ title=配置帮助 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/grid/grid_4/configuring_components/config_help/>配置帮助
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/zh-cn/grid/grid_4/graphql_support/ title=GraphQL查询支持 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/grid/grid_4/graphql_support/>GraphQL查询支持
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/grid/grid_4/advanced_features/ title=高级功能 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/grid/grid_4/advanced_features/>高级功能
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/zh-cn/grid/grid_4/advanced_features/observability/ title=可观察性 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/grid/grid_4/advanced_features/observability/>可观察性
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/zh-cn/grid/grid_4/grid_endpoints/ title=网格端点 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/grid/grid_4/grid_endpoints/>网格端点
<i class="fas fa-check read-icon"></i></a></li></ul></li></ul></li><li data-nav-id=/zh-cn/driver_idiosyncrasies/ title=驱动特性 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/driver_idiosyncrasies/>驱动特性
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/zh-cn/driver_idiosyncrasies/shared_capabilities/ title=共享的功能 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/driver_idiosyncrasies/shared_capabilities/>共享的功能
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/driver_idiosyncrasies/driver_specific_capabilities/ title=驱动特定的功能 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/driver_idiosyncrasies/driver_specific_capabilities/>驱动特定的功能
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/zh-cn/support_packages/ title=支持的包 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/support_packages/>支持的包
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/zh-cn/support_packages/working_with_colours/ title=同颜色一起工作 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/support_packages/working_with_colours/>同颜色一起工作
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/support_packages/working_with_select_elements/ title=同选择元素一起工作 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/support_packages/working_with_select_elements/>同选择元素一起工作
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/support_packages/mouse_and_keyboard_actions_in_detail/ title=鼠标动作详细信息 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/support_packages/mouse_and_keyboard_actions_in_detail/>鼠标动作详细信息
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/support_packages/working_with_cookies/ title=同cookies一起工作 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/support_packages/working_with_cookies/>同cookies一起工作
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/support_packages/chrome_devtools/ title=Chrome开发工具 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/support_packages/chrome_devtools/>Chrome开发工具
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/zh-cn/legacy_docs/ title=Legacy class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/legacy_docs/>Legacy
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/zh-cn/legacy_docs/selenium_rc/ title="Selenium 1 (Selenium RC)" class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/legacy_docs/selenium_rc/>Selenium 1 (Selenium RC)
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/legacy_docs/migrating_from_rc_to_webdriver/ title=从RC迁移到WebDriver class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/legacy_docs/migrating_from_rc_to_webdriver/>从RC迁移到WebDriver
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/legacy_docs/html-runner/ title="HTML runner" class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/legacy_docs/html-runner/>HTML runner
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/legacy_docs/selenium_ide/ title="Legacy Selenium IDE" class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/legacy_docs/selenium_ide/>Legacy Selenium IDE
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/legacy_docs/remote_webdriver_server/ title=远程WebDriver服务器 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/legacy_docs/remote_webdriver_server/>远程WebDriver服务器
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/zh-cn/front_matter/ title=版权页 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/front_matter/>版权页
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/zh-cn/front_matter/copyright_and_attributions/ title=版权和归属 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/front_matter/copyright_and_attributions/>版权和归属
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/zh-cn/front_matter/typographical_conventions/ title=排版协议 class=dd-item><a href=https://www.selenium.dev/documentation/zh-cn/front_matter/typographical_conventions/>排版协议
<i class="fas fa-check read-icon"></i></a></li></ul></li></ul><section id=shortcuts><h3>更多</h3><ul><li><a class=padding href=https://www.selenium.dev/><i class="fas fa-home"></i>Selenium Home</a></li><li><a class=padding href=https://github.com/SeleniumHQ/seleniumhq.github.io><i class="fab fa-fw fa-github"></i>GitHub repo</a></li><li><a class=padding href=https://github.com/seleniumhq/seleniumhq.github.io/issues><i class="fas fa-fw fa-exclamation-triangle"></i>Report a bug</a></li><li><a class=padding href=https://www.selenium.dev/documentation/zh-cn/front_matter/copyright_and_attributions><i class="fas fa-fw fa-trophy"></i>Credits</a></li><li><a class=padding href=https://www.selenium.dev/documentation/zh-cn/contributing><i class="fas fa-fw fa-bullhorn"></i>How to contribute</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value;">
<option id=de value=https://www.selenium.dev/documentation/de/webdriver/browser_manipulation/>Deutsch</option>
<option id=en value=https://www.selenium.dev/documentation/en/webdriver/browser_manipulation/>English</option>
<option id=pt-br value=https://www.selenium.dev/documentation/pt-br/webdriver/browser_manipulation/>Português (Brasileiro)</option>
<option id=es value=https://www.selenium.dev/documentation/es/webdriver/browser_manipulation/>Español</option>
<option id=nl value=https://www.selenium.dev/documentation/nl/webdriver/browser_manipulation/>Nederlands</option>
<option id=zh-cn value=https://www.selenium.dev/documentation/zh-cn/webdriver/browser_manipulation/ selected>中文简体</option>
<option id=fr value=https://www.selenium.dev/documentation/fr/webdriver/browser_manipulation/>Français</option>
<option id=ja value=https://www.selenium.dev/documentation/ja/webdriver/browser_manipulation/>日本語</option>
<option id=ko value=https://www.selenium.dev/documentation/ko/webdriver/browser_manipulation/>한국어</option></select><svg id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75" /></g></g></svg></div></a></li><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i>清理历史记录</a></li></ul></section><section id=footer><p>&copy; 2013-2021</p><p>Software Freedom Conservancy (SFC)</p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title="Edit this page" href=https://github.com/SeleniumHQ/seleniumhq.github.io/edit/dev/docs_source_files/content/webdriver/browser_manipulation.zh-cn.md target=blank><i class="fas fa-code-branch"></i><span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links><a href=https://www.selenium.dev/documentation/zh-cn/>Selenium 浏览器自动化项目</a> > <a href=https://www.selenium.dev/documentation/zh-cn/webdriver/>WebDriver</a> > 操控浏览器</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#ruby>Ruby</a></li><li><a href=#internet-explorer>Internet Explorer</a></li><li><a href=#浏览器导航>浏览器导航</a><ul><li><a href=#打开网站>打开网站</a></li><li><a href=#获取当前-url>获取当前 URL</a></li><li><a href=#后退>后退</a></li><li><a href=#前进>前进</a></li><li><a href=#刷新>刷新</a></li><li><a href=#获取标题>获取标题</a></li></ul></li><li><a href=#窗口和标签页>窗口和标签页</a><ul><li><a href=#切换窗口或标签页>切换窗口或标签页</a></li><li><a href=#创建新窗口或新标签页并且切换>创建新窗口(或)新标签页并且切换</a></li><li><a href=#关闭窗口或标签页>关闭窗口或标签页</a></li><li><a href=#在会话结束时退出浏览器>在会话结束时退出浏览器</a></li></ul></li><li><a href=#frames-and-iframes>Frames and Iframes</a><ul><li><a href=#使用-webelement>使用 WebElement</a></li><li><a href=#使用-name-或-id>使用 name 或 id</a></li><li><a href=#使用索引>使用索引</a></li><li><a href=#离开框架>离开框架</a></li></ul></li><li><a href=#窗口管理>窗口管理</a><ul><li><a href=#获取窗口大小>获取窗口大小</a></li><li><a href=#设置窗口大小>设置窗口大小</a></li><li><a href=#得到窗口的位置>得到窗口的位置</a></li></ul></li><li><a href=#设置窗口位置>设置窗口位置</a><ul><li><a href=#最大化窗口>最大化窗口</a></li><li><a href=#最小化窗口>最小化窗口</a></li><li><a href=#全屏窗口>全屏窗口</a></li><li><a href=#屏幕截图>屏幕截图</a></li><li><a href=#元素屏幕截图>元素屏幕截图</a></li><li><a href=#执行脚本>执行脚本</a></li><li><a href=#打印页面>打印页面</a></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>操控浏览器</h1><h2 id=ruby>Ruby</h2><p>默认情况下，Ruby 没有安装在 Windows 上。下载最新<a href=//rubyinstaller.org/downloads>版本</a>
并运行安装程序。你可以保留所有设置的默认值，除要勾选 <em>安装位置和可选任务</em> 屏幕上
<em>将 Ruby 可执行程序添加到您的系统路径</em> 复选框外。想要驱动任何浏览器，你必须安装 <code>selenium-webdriver</code>
Ruby gem. 打开命令提示符并输入以下命令来安装它:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>gem install selenium-webdriver
</code></pre></div><p>如果你使用 <a href=//bundler.io>Bundler</a>，添加这一行到你的应用程序的 Gemfile 中:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>gem <span style=color:#2aa198>&#34;selenium-webdriver&#34;</span>
</code></pre></div><p>然后在命令提示符中执行以下命令：</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>bundle install
</code></pre></div><h2 id=internet-explorer>Internet Explorer</h2><p>IE 浏览器默认安装在 Windows 上，不需要再次安装。要在 Windows 上驱动 IE，您必须下载最新的
<a href=https://selenium.dev/downloads/>Internet Explorer 驱动程序</a> 并将文件放入 <code>PATH</code>
路径中的文件夹中。要查看 <code>PATH</code> 路径中的目录，在命令提示符中键入 <code>echo %PATH%</code>。</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bat data-lang=bat>$ echo <span style=color:#268bd2>%PATH%</span>
C:\Ruby200\bin<span style=color:#586e75>;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem</span>
</code></pre></div><p><code>C:\Ruby200\bin</code> 看起来是个不错的位置。解压 IEDriverServer 文件并将 IEDriverServer.exe 移动进去。</p><p>这将打开一个新的 IE 浏览器窗口:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#b58900>require</span> <span style=color:#2aa198>&#34;selenium-webdriver&#34;</span>
driver <span style=color:#719e07>=</span> <span style=color:#cb4b16>Selenium</span><span style=color:#719e07>::</span><span style=color:#cb4b16>WebDriver</span><span style=color:#719e07>.</span>for <span style=color:#2aa198>:internet_explorer</span>
</code></pre></div><h2 id=浏览器导航>浏览器导航</h2><h3 id=打开网站>打开网站</h3><p>启动浏览器后你要做的第一件事就是打开你的网站。这可以通过一行代码实现:</p><div class=tabset><input type=radio name=tabsetcode0 class=tabjava id=tab0code0 aria-controls=javacode0 onclick=handleClick(this); value=java checked>
<label for=tab0code0>Java</label>
<input type=radio name=tabsetcode0 class=tabpython id=tab1code0 aria-controls=pythoncode0 onclick=handleClick(this); value=python>
<label for=tab1code0>Python</label>
<input type=radio name=tabsetcode0 class=tabcs id=tab2code0 aria-controls=cscode0 onclick=handleClick(this); value=cs>
<label for=tab2code0>C#</label>
<input type=radio name=tabsetcode0 class=tabruby id=tab3code0 aria-controls=rubycode0 onclick=handleClick(this); value=ruby>
<label for=tab3code0>Ruby</label>
<input type=radio name=tabsetcode0 class=tabjavascript id=tab4code0 aria-controls=javascriptcode0 onclick=handleClick(this); value=javascript>
<label for=tab4code0>JavaScript</label>
<input type=radio name=tabsetcode0 class=tabkotlin id=tab5code0 aria-controls=kotlincode0 onclick=handleClick(this); value=kotlin>
<label for=tab5code0>Kotlin</label><div class=tab-panels><section id=javacode0 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>
<span style=color:#586e75>// 简便的方法
</span><span style=color:#586e75></span>driver<span style=color:#719e07>.</span>get<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;https://selenium.dev&#34;</span><span style=color:#719e07>);</span>

<span style=color:#586e75>// 更长的方法
</span><span style=color:#586e75></span>driver<span style=color:#719e07>.</span>navigate<span style=color:#719e07>().</span>to<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;https://selenium.dev&#34;</span><span style=color:#719e07>);</span>
</code></pre></div></section><section id=pythoncode0 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>
driver<span style=color:#719e07>.</span>get(<span style=color:#2aa198>&#34;https://selenium.dev&#34;</span>)
</code></pre></div></section><section id=csharpcode0 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>
driver.Navigate().GoToUrl(<span style=color:#2aa198>@&#34;https://selenium.dev&#34;</span>);
</code></pre></div></section><section id=rubycode0 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>
<span style=color:#586e75># 简便的方法</span>
driver<span style=color:#719e07>.</span>get <span style=color:#2aa198>&#39;https://selenium.dev&#39;</span>

<span style=color:#586e75># 更长的方法</span>
driver<span style=color:#719e07>.</span>navigate<span style=color:#719e07>.</span>to <span style=color:#2aa198>&#39;https://selenium.dev&#39;</span>
</code></pre></div></section><section id=javascriptcode0 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>
await driver.get(<span style=color:#2aa198>&#39;https://selenium.dev&#39;</span>);
</code></pre></div></section><section id=kotlincode0 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>
<span style=color:#586e75>// 简便的方法
</span><span style=color:#586e75></span>driver.<span style=color:#719e07>get</span>(<span style=color:#2aa198>&#34;https://selenium.dev&#34;</span>)

<span style=color:#586e75>// 更长的方法
</span><span style=color:#586e75></span>driver.navigate().to(<span style=color:#2aa198>&#34;https://selenium.dev&#34;</span>)
</code></pre></div></section></div></div><h3 id=获取当前-url>获取当前 URL</h3><p>您可以从浏览器的地址栏读取当前的 URL，使用:</p><div class=tabset><input type=radio name=tabsetcode1 class=tabjava id=tab0code1 aria-controls=javacode1 onclick=handleClick(this); value=java checked>
<label for=tab0code1>Java</label>
<input type=radio name=tabsetcode1 class=tabpython id=tab1code1 aria-controls=pythoncode1 onclick=handleClick(this); value=python>
<label for=tab1code1>Python</label>
<input type=radio name=tabsetcode1 class=tabcs id=tab2code1 aria-controls=cscode1 onclick=handleClick(this); value=cs>
<label for=tab2code1>C#</label>
<input type=radio name=tabsetcode1 class=tabruby id=tab3code1 aria-controls=rubycode1 onclick=handleClick(this); value=ruby>
<label for=tab3code1>Ruby</label>
<input type=radio name=tabsetcode1 class=tabjavascript id=tab4code1 aria-controls=javascriptcode1 onclick=handleClick(this); value=javascript>
<label for=tab4code1>JavaScript</label>
<input type=radio name=tabsetcode1 class=tabkotlin id=tab5code1 aria-controls=kotlincode1 onclick=handleClick(this); value=kotlin>
<label for=tab5code1>Kotlin</label><div class=tab-panels><section id=javacode1 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>driver<span style=color:#719e07>.</span>getCurrentUrl<span style=color:#719e07>();</span></code></pre></div></section><section id=pythoncode1 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>driver<span style=color:#719e07>.</span>current_url</code></pre></div></section><section id=csharpcode1 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>driver.Url;
</code></pre></div></section><section id=rubycode1 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>driver<span style=color:#719e07>.</span>current_url</code></pre></div></section><section id=javascriptcode1 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>await driver.getCurrentUrl();
</code></pre></div></section><section id=kotlincode1 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>driver.currentUrl</code></pre></div></section></div></div><h3 id=后退>后退</h3><p>按下浏览器的后退按钮:</p><div class=tabset><input type=radio name=tabsetcode2 class=tabjava id=tab0code2 aria-controls=javacode2 onclick=handleClick(this); value=java checked>
<label for=tab0code2>Java</label>
<input type=radio name=tabsetcode2 class=tabpython id=tab1code2 aria-controls=pythoncode2 onclick=handleClick(this); value=python>
<label for=tab1code2>Python</label>
<input type=radio name=tabsetcode2 class=tabcs id=tab2code2 aria-controls=cscode2 onclick=handleClick(this); value=cs>
<label for=tab2code2>C#</label>
<input type=radio name=tabsetcode2 class=tabruby id=tab3code2 aria-controls=rubycode2 onclick=handleClick(this); value=ruby>
<label for=tab3code2>Ruby</label>
<input type=radio name=tabsetcode2 class=tabjavascript id=tab4code2 aria-controls=javascriptcode2 onclick=handleClick(this); value=javascript>
<label for=tab4code2>JavaScript</label>
<input type=radio name=tabsetcode2 class=tabkotlin id=tab5code2 aria-controls=kotlincode2 onclick=handleClick(this); value=kotlin>
<label for=tab5code2>Kotlin</label><div class=tab-panels><section id=javacode2 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>driver<span style=color:#719e07>.</span>navigate<span style=color:#719e07>().</span>back<span style=color:#719e07>();</span></code></pre></div></section><section id=pythoncode2 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>driver<span style=color:#719e07>.</span>back()</code></pre></div></section><section id=csharpcode2 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>driver.Navigate().Back();
</code></pre></div></section><section id=rubycode2 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>driver<span style=color:#719e07>.</span>navigate<span style=color:#719e07>.</span>back</code></pre></div></section><section id=javascriptcode2 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>await driver.navigate().back();
</code></pre></div></section><section id=kotlincode2 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>driver.navigate().back() </code></pre></div></section></div></div><h3 id=前进>前进</h3><p>按下浏览器的前进键:</p><div class=tabset><input type=radio name=tabsetcode3 class=tabjava id=tab0code3 aria-controls=javacode3 onclick=handleClick(this); value=java checked>
<label for=tab0code3>Java</label>
<input type=radio name=tabsetcode3 class=tabpython id=tab1code3 aria-controls=pythoncode3 onclick=handleClick(this); value=python>
<label for=tab1code3>Python</label>
<input type=radio name=tabsetcode3 class=tabcs id=tab2code3 aria-controls=cscode3 onclick=handleClick(this); value=cs>
<label for=tab2code3>C#</label>
<input type=radio name=tabsetcode3 class=tabruby id=tab3code3 aria-controls=rubycode3 onclick=handleClick(this); value=ruby>
<label for=tab3code3>Ruby</label>
<input type=radio name=tabsetcode3 class=tabjavascript id=tab4code3 aria-controls=javascriptcode3 onclick=handleClick(this); value=javascript>
<label for=tab4code3>JavaScript</label>
<input type=radio name=tabsetcode3 class=tabkotlin id=tab5code3 aria-controls=kotlincode3 onclick=handleClick(this); value=kotlin>
<label for=tab5code3>Kotlin</label><div class=tab-panels><section id=javacode3 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>driver<span style=color:#719e07>.</span>navigate<span style=color:#719e07>().</span>forward<span style=color:#719e07>();</span></code></pre></div></section><section id=pythoncode3 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>driver<span style=color:#719e07>.</span>forward()</code></pre></div></section><section id=csharpcode3 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>driver.Navigate().Forward();
</code></pre></div></section><section id=rubycode3 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>driver<span style=color:#719e07>.</span>navigate<span style=color:#719e07>.</span>forward</code></pre></div></section><section id=javascriptcode3 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>await driver.navigate().forward();
</code></pre></div></section><section id=kotlincode3 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>driver.navigate().forward()</code></pre></div></section></div></div><h3 id=刷新>刷新</h3><p>刷新当前页面:</p><div class=tabset><input type=radio name=tabsetcode4 class=tabjava id=tab0code4 aria-controls=javacode4 onclick=handleClick(this); value=java checked>
<label for=tab0code4>Java</label>
<input type=radio name=tabsetcode4 class=tabpython id=tab1code4 aria-controls=pythoncode4 onclick=handleClick(this); value=python>
<label for=tab1code4>Python</label>
<input type=radio name=tabsetcode4 class=tabcs id=tab2code4 aria-controls=cscode4 onclick=handleClick(this); value=cs>
<label for=tab2code4>C#</label>
<input type=radio name=tabsetcode4 class=tabruby id=tab3code4 aria-controls=rubycode4 onclick=handleClick(this); value=ruby>
<label for=tab3code4>Ruby</label>
<input type=radio name=tabsetcode4 class=tabjavascript id=tab4code4 aria-controls=javascriptcode4 onclick=handleClick(this); value=javascript>
<label for=tab4code4>JavaScript</label>
<input type=radio name=tabsetcode4 class=tabkotlin id=tab5code4 aria-controls=kotlincode4 onclick=handleClick(this); value=kotlin>
<label for=tab5code4>Kotlin</label><div class=tab-panels><section id=javacode4 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>driver<span style=color:#719e07>.</span>navigate<span style=color:#719e07>().</span>refresh<span style=color:#719e07>();</span></code></pre></div></section><section id=pythoncode4 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>driver<span style=color:#719e07>.</span>refresh()</code></pre></div></section><section id=csharpcode4 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>driver.Navigate().Refresh();
</code></pre></div></section><section id=rubycode4 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>driver<span style=color:#719e07>.</span>navigate<span style=color:#719e07>.</span>refresh</code></pre></div></section><section id=javascriptcode4 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>await driver.navigate().refresh();
</code></pre></div></section><section id=kotlincode4 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>driver.navigate().refresh()</code></pre></div></section></div></div><h3 id=获取标题>获取标题</h3><p>从浏览器中读取当前页面的标题:</p><div class=tabset><input type=radio name=tabsetcode5 class=tabjava id=tab0code5 aria-controls=javacode5 onclick=handleClick(this); value=java checked>
<label for=tab0code5>Java</label>
<input type=radio name=tabsetcode5 class=tabpython id=tab1code5 aria-controls=pythoncode5 onclick=handleClick(this); value=python>
<label for=tab1code5>Python</label>
<input type=radio name=tabsetcode5 class=tabcs id=tab2code5 aria-controls=cscode5 onclick=handleClick(this); value=cs>
<label for=tab2code5>C#</label>
<input type=radio name=tabsetcode5 class=tabruby id=tab3code5 aria-controls=rubycode5 onclick=handleClick(this); value=ruby>
<label for=tab3code5>Ruby</label>
<input type=radio name=tabsetcode5 class=tabjavascript id=tab4code5 aria-controls=javascriptcode5 onclick=handleClick(this); value=javascript>
<label for=tab4code5>JavaScript</label>
<input type=radio name=tabsetcode5 class=tabkotlin id=tab5code5 aria-controls=kotlincode5 onclick=handleClick(this); value=kotlin>
<label for=tab5code5>Kotlin</label><div class=tab-panels><section id=javacode5 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>driver<span style=color:#719e07>.</span>getTitle<span style=color:#719e07>();</span></code></pre></div></section><section id=pythoncode5 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>driver<span style=color:#719e07>.</span>title</code></pre></div></section><section id=csharpcode5 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>driver.Title;
</code></pre></div></section><section id=rubycode5 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>driver<span style=color:#719e07>.</span>title</code></pre></div></section><section id=javascriptcode5 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>await driver.getTitle();
</code></pre></div></section><section id=kotlincode5 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>driver.title</code></pre></div></section></div></div><h2 id=窗口和标签页>窗口和标签页</h2><p>WebDriver 没有区分窗口和标签页。如果你的站点打开了一个新标签页或窗口，Selenium 将允许您使用窗口句柄来处理它。
每个窗口都有一个唯一的标识符，该标识符在单个会话中保持持久性。你可以使用以下方法获得当前窗口的窗口句柄:</p><div class=tabset><input type=radio name=tabsetcode6 class=tabjava id=tab0code6 aria-controls=javacode6 onclick=handleClick(this); value=java checked>
<label for=tab0code6>Java</label>
<input type=radio name=tabsetcode6 class=tabpython id=tab1code6 aria-controls=pythoncode6 onclick=handleClick(this); value=python>
<label for=tab1code6>Python</label>
<input type=radio name=tabsetcode6 class=tabcs id=tab2code6 aria-controls=cscode6 onclick=handleClick(this); value=cs>
<label for=tab2code6>C#</label>
<input type=radio name=tabsetcode6 class=tabruby id=tab3code6 aria-controls=rubycode6 onclick=handleClick(this); value=ruby>
<label for=tab3code6>Ruby</label>
<input type=radio name=tabsetcode6 class=tabjavascript id=tab4code6 aria-controls=javascriptcode6 onclick=handleClick(this); value=javascript>
<label for=tab4code6>JavaScript</label>
<input type=radio name=tabsetcode6 class=tabkotlin id=tab5code6 aria-controls=kotlincode6 onclick=handleClick(this); value=kotlin>
<label for=tab5code6>Kotlin</label><div class=tab-panels><section id=javacode6 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>driver<span style=color:#719e07>.</span>getWindowHandle<span style=color:#719e07>();</span></code></pre></div></section><section id=pythoncode6 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>driver<span style=color:#719e07>.</span>current_window_handle</code></pre></div></section><section id=csharpcode6 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>driver.CurrentWindowHandle;
</code></pre></div></section><section id=rubycode6 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>driver<span style=color:#719e07>.</span>window_handle</code></pre></div></section><section id=javascriptcode6 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>await driver.getWindowHandle();
</code></pre></div></section><section id=kotlincode6 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>driver.windowHandle</code></pre></div></section></div></div><h3 id=切换窗口或标签页>切换窗口或标签页</h3><p>单击在 &lt;a href="https://seleniumhq.github.io"target=&rdquo;_blank">新窗口</a> 中打开链接，
则屏幕会聚焦在新窗口或新标签页上，但 WebDriver 不知道操作系统认为哪个窗口是活动的。
要使用新窗口，您需要切换到它。 如果只有两个选项卡或窗口被打开，并且你知道从哪个窗口开始，
则你可以遍历 WebDriver， 通过排除法可以看到两个窗口或选项卡，然后切换到你需要的窗口或选项卡。</p><p>不过，Selenium 4 提供了一个新的 api
<a href=https://selenium.dev/documentation/zh-cn/webdriver/browser_manipulation/#创建新窗口(或)新标签页并且切换>NewWindow </a>，
它创建一个新选项卡 (或) 新窗口并自动切换到它。</p><div class=tabset><input type=radio name=tabsetcode7 class=tabjava id=tab0code7 aria-controls=javacode7 onclick=handleClick(this); value=java checked>
<label for=tab0code7>Java</label>
<input type=radio name=tabsetcode7 class=tabpython id=tab1code7 aria-controls=pythoncode7 onclick=handleClick(this); value=python>
<label for=tab1code7>Python</label>
<input type=radio name=tabsetcode7 class=tabcs id=tab2code7 aria-controls=cscode7 onclick=handleClick(this); value=cs>
<label for=tab2code7>C#</label>
<input type=radio name=tabsetcode7 class=tabruby id=tab3code7 aria-controls=rubycode7 onclick=handleClick(this); value=ruby>
<label for=tab3code7>Ruby</label>
<input type=radio name=tabsetcode7 class=tabjavascript id=tab4code7 aria-controls=javascriptcode7 onclick=handleClick(this); value=javascript>
<label for=tab4code7>JavaScript</label>
<input type=radio name=tabsetcode7 class=tabkotlin id=tab5code7 aria-controls=kotlincode7 onclick=handleClick(this); value=kotlin>
<label for=tab5code7>Kotlin</label><div class=tab-panels><section id=javacode7 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>
<span style=color:#586e75>// 存储原始窗口的 ID
</span><span style=color:#586e75></span>String originalWindow <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>getWindowHandle<span style=color:#719e07>();</span>

<span style=color:#586e75>// 检查一下，我们还没有打开其他的窗口
</span><span style=color:#586e75></span><span style=color:#719e07>assert</span> driver<span style=color:#719e07>.</span>getWindowHandles<span style=color:#719e07>().</span>size<span style=color:#719e07>()</span> <span style=color:#719e07>==</span> 1<span style=color:#719e07>;</span>

<span style=color:#586e75>// 点击在新窗口中打开的链接
</span><span style=color:#586e75></span>driver<span style=color:#719e07>.</span>findElement<span style=color:#719e07>(</span>By<span style=color:#719e07>.</span>linkText<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;new window&#34;</span><span style=color:#719e07>)).</span>click<span style=color:#719e07>();</span>

<span style=color:#586e75>// 等待新窗口或标签页
</span><span style=color:#586e75></span>wait<span style=color:#719e07>.</span>until<span style=color:#719e07>(</span>numberOfWindowsToBe<span style=color:#719e07>(</span>2<span style=color:#719e07>));</span>

<span style=color:#586e75>// 循环执行，直到找到一个新的窗口句柄
</span><span style=color:#586e75></span><span style=color:#719e07>for</span> <span style=color:#719e07>(</span>String windowHandle <span style=color:#719e07>:</span> driver<span style=color:#719e07>.</span>getWindowHandles<span style=color:#719e07>())</span> <span style=color:#719e07>{</span><span style=color:#719e07>if</span><span style=color:#719e07>(!</span>originalWindow<span style=color:#719e07>.</span>contentEquals<span style=color:#719e07>(</span>windowHandle<span style=color:#719e07>))</span> <span style=color:#719e07>{</span>driver<span style=color:#719e07>.</span>switchTo<span style=color:#719e07>().</span>window<span style=color:#719e07>(</span>windowHandle<span style=color:#719e07>);</span>
<span style=color:#719e07>break</span><span style=color:#719e07>;</span>
<span style=color:#719e07>}</span>
<span style=color:#719e07>}</span>

<span style=color:#586e75>// 等待新标签完成加载内容
</span><span style=color:#586e75></span>wait<span style=color:#719e07>.</span>until<span style=color:#719e07>(</span>titleIs<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;Selenium documentation&#34;</span><span style=color:#719e07>));</span>
</code></pre></div></section><section id=pythoncode7 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>
<span style=color:#719e07>from</span> selenium <span style=color:#719e07>import</span> webdriver
<span style=color:#719e07>from</span> selenium.webdriver.support.ui <span style=color:#719e07>import</span> WebDriverWait
<span style=color:#719e07>from</span> selenium.webdriver.support <span style=color:#719e07>import</span> expected_conditions <span style=color:#719e07>as</span> EC

<span style=color:#586e75># 启动驱动程序</span>
<span style=color:#719e07>with</span> webdriver<span style=color:#719e07>.</span>Firefox() <span style=color:#719e07>as</span> driver:
<span style=color:#586e75># 打开网址</span>
driver<span style=color:#719e07>.</span>get(<span style=color:#2aa198>&#34;https://seleniumhq.github.io&#34;</span>)

    <span style=color:#586e75># 设置等待</span>
    wait <span style=color:#719e07>=</span> WebDriverWait(driver, <span style=color:#2aa198>10</span>)

    <span style=color:#586e75># 存储原始窗口的 ID</span>
    original_window <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>current_window_handle

    <span style=color:#586e75># 检查一下，我们还没有打开其他的窗口</span>
    <span style=color:#719e07>assert</span> <span style=color:#b58900>len</span>(driver<span style=color:#719e07>.</span>window_handles) <span style=color:#719e07>==</span> <span style=color:#2aa198>1</span>

    <span style=color:#586e75># 单击在新窗口中打开的链接</span>
    driver<span style=color:#719e07>.</span>find_element(By<span style=color:#719e07>.</span>LINK_TEXT, <span style=color:#2aa198>&#34;new window&#34;</span>)<span style=color:#719e07>.</span>click()

    <span style=color:#586e75># 等待新窗口或标签页</span>
    wait<span style=color:#719e07>.</span>until(EC<span style=color:#719e07>.</span>number_of_windows_to_be(<span style=color:#2aa198>2</span>))

    <span style=color:#586e75># 循环执行，直到找到一个新的窗口句柄</span>
    <span style=color:#719e07>for</span> window_handle <span style=color:#719e07>in</span> driver<span style=color:#719e07>.</span>window_handles:
        <span style=color:#719e07>if</span> window_handle <span style=color:#719e07>!=</span> original_window:
            driver<span style=color:#719e07>.</span>switch_to<span style=color:#719e07>.</span>window(window_handle)
            <span style=color:#719e07>break</span>

    <span style=color:#586e75># 等待新标签页完成加载内容</span>
    wait<span style=color:#719e07>.</span>until(EC<span style=color:#719e07>.</span>title_is(<span style=color:#2aa198>&#34;SeleniumHQ Browser Automation&#34;</span>))
</code></pre></div></section><section id=csharpcode7 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>
<span style=color:#586e75>// 存储原始窗口的 ID
</span><span style=color:#586e75></span><span style=color:#dc322f>string</span> originalWindow = driver.CurrentWindowHandle;

<span style=color:#586e75>// 检查一下，我们还没有打开其他的窗口
</span><span style=color:#586e75></span>Assert.AreEqual(driver.WindowHandles.Count, <span style=color:#2aa198>1</span>);

<span style=color:#586e75>// 单击在新窗口中打开的链接
</span><span style=color:#586e75></span>driver.FindElement(By.LinkText(<span style=color:#2aa198>&#34;new window&#34;</span>)).Click();

<span style=color:#586e75>// 等待新窗口或标签页
</span><span style=color:#586e75></span>wait.Until(wd =&gt; wd.WindowHandles.Count == <span style=color:#2aa198>2</span>);

<span style=color:#586e75>// 循环执行，直到找到一个新的窗口句柄
</span><span style=color:#586e75></span><span style=color:#719e07>foreach</span>(<span style=color:#dc322f>string</span> window <span style=color:#719e07>in</span> driver.WindowHandles)
{<span style=color:#719e07>if</span>(originalWindow != window)
{driver.SwitchTo().Window(window);
<span style=color:#719e07>break</span>;
}
}
<span style=color:#586e75>// 等待新标签页完成加载内容
</span><span style=color:#586e75></span>wait.Until(wd =&gt; wd.Title == <span style=color:#2aa198>&#34;Selenium documentation&#34;</span>);
</code></pre></div></section><section id=rubycode7 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>
<span style=color:#586e75># 存储原始窗口的 ID</span>
original_window <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>window_handle

<span style=color:#586e75>#检查一下，我们还没有打开其他的窗口</span>
assert(driver<span style=color:#719e07>.</span>window_handles<span style=color:#719e07>.</span>length <span style=color:#719e07>==</span> <span style=color:#2aa198>1</span>,<span style=color:#2aa198>&#39;Expected one window&#39;</span>)

<span style=color:#586e75>#点击在新窗口中打开的链接</span>
driver<span style=color:#719e07>.</span>find_element(<span style=color:#2aa198>link</span>:<span style=color:#2aa198>&#39;new window&#39;</span>)<span style=color:#719e07>.</span>click

<span style=color:#586e75>#等待新窗口或标签页</span>
wait<span style=color:#719e07>.</span>until {driver<span style=color:#719e07>.</span>window_handles<span style=color:#719e07>.</span>length <span style=color:#719e07>==</span> <span style=color:#2aa198>2</span>}

<span style=color:#586e75>#循环执行，直到找到一个新的窗口句柄</span>
driver<span style=color:#719e07>.</span>window_handles<span style=color:#719e07>.</span>each <span style=color:#719e07>do</span> <span style=color:#719e07>|</span>handle<span style=color:#719e07>|</span>
<span style=color:#719e07>if</span> handle <span style=color:#719e07>!=</span> original_window
driver<span style=color:#719e07>.</span>switch_to<span style=color:#719e07>.</span>window handle
<span style=color:#719e07>break</span>
<span style=color:#719e07>end</span>
<span style=color:#719e07>end</span>

<span style=color:#586e75>#等待新标签页完成加载内容</span>
wait<span style=color:#719e07>.</span>until {driver<span style=color:#719e07>.</span>title <span style=color:#719e07>==</span><span style=color:#2aa198>&#39;Selenium documentation&#39;</span>}
</code></pre></div></section><section id=javascriptcode7 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>
<span style=color:#586e75>// 存储原始窗口的 ID
</span><span style=color:#586e75></span><span style=color:#268bd2>const</span> originalWindow <span style=color:#719e07>=</span> await driver.getWindowHandle();

<span style=color:#586e75>// 检查一下，我们还没有打开其他的窗口
</span><span style=color:#586e75></span>assert((await driver.getAllWindowHandles()).length <span style=color:#719e07>===</span> <span style=color:#2aa198>1</span>);

<span style=color:#586e75>// 点击在新窗口中打开的链接
</span><span style=color:#586e75></span>await driver.findElement(By.linkText(<span style=color:#2aa198>&#39;new window&#39;</span>)).click();

<span style=color:#586e75>// 等待新窗口或标签页
</span><span style=color:#586e75></span>await driver.wait(async () =&gt; (await driver.getAllWindowHandles()).length <span style=color:#719e07>===</span> <span style=color:#2aa198>2</span>,
<span style=color:#2aa198>10000</span>
);

<span style=color:#586e75>// 循环执行，直到找到一个新的窗口句柄
</span><span style=color:#586e75></span><span style=color:#268bd2>const</span> windows <span style=color:#719e07>=</span> await driver.getAllWindowHandles();
windows.forEach(async handle =&gt; {<span style=color:#719e07>if</span> (handle <span style=color:#719e07>!==</span> originalWindow) {await driver.switchTo().<span style=color:#b58900>window</span>(handle);
}
});

<span style=color:#586e75>// 等待新标签页完成加载内容
</span><span style=color:#586e75></span>await driver.wait(until.titleIs(<span style=color:#2aa198>&#39;Selenium documentation&#39;</span>), <span style=color:#2aa198>10000</span>);
</code></pre></div></section><section id=kotlincode7 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>
<span style=color:#586e75>// 存储原始窗口的 ID
</span><span style=color:#586e75></span><span style=color:#719e07>val</span> originalWindow = driver.getWindowHandle()

<span style=color:#586e75>// 检查一下，我们还没有打开其他的窗口
</span><span style=color:#586e75></span>assert(driver.getWindowHandles().size() === <span style=color:#2aa198>1</span>)

<span style=color:#586e75>// 点击在新窗口中打开的链接
</span><span style=color:#586e75></span>driver.findElement(By.linkText(<span style=color:#2aa198>&#34;new window&#34;</span>)).click()

<span style=color:#586e75>// 等待新窗口或标签页
</span><span style=color:#586e75></span>wait.until(numberOfWindowsToBe(<span style=color:#2aa198>2</span>))

<span style=color:#586e75>// 循环执行，直到找到一个新的窗口句柄
</span><span style=color:#586e75></span><span style=color:#719e07>for</span> (windowHandle <span style=color:#719e07>in</span> driver.getWindowHandles()) {
<span style=color:#719e07>if</span> (!originalWindow.contentEquals(windowHandle)) {
driver.switchTo().window(windowHandle)
<span style=color:#719e07>break</span>
}
}

<span style=color:#586e75>// 等待新标签页完成加载内容
</span><span style=color:#586e75></span>wait.until(titleIs(<span style=color:#2aa198>&#34;Selenium documentation&#34;</span>))

</code></pre></div></section></div></div><h3 id=创建新窗口或新标签页并且切换>创建新窗口(或)新标签页并且切换</h3><p>创建一个新窗口 (或) 标签页，屏幕焦点将聚焦在新窗口或标签在上。您不需要切换到新窗口 (或) 标签页。如果除了新窗口之外，
您打开了两个以上的窗口 (或) 标签页，您可以通过遍历 WebDriver 看到两个窗口或选项卡，并切换到非原始窗口。</p><p><em>注意: 该特性适用于 Selenium 4 及其后续版本。</em></p><div class=tabset><input type=radio name=tabsetcode8 class=tabjava id=tab0code8 aria-controls=javacode8 onclick=handleClick(this); value=java checked>
<label for=tab0code8>Java</label>
<input type=radio name=tabsetcode8 class=tabpython id=tab1code8 aria-controls=pythoncode8 onclick=handleClick(this); value=python>
<label for=tab1code8>Python</label>
<input type=radio name=tabsetcode8 class=tabcs id=tab2code8 aria-controls=cscode8 onclick=handleClick(this); value=cs>
<label for=tab2code8>C#</label>
<input type=radio name=tabsetcode8 class=tabruby id=tab3code8 aria-controls=rubycode8 onclick=handleClick(this); value=ruby>
<label for=tab3code8>Ruby</label>
<input type=radio name=tabsetcode8 class=tabjavascript id=tab4code8 aria-controls=javascriptcode8 onclick=handleClick(this); value=javascript>
<label for=tab4code8>JavaScript</label>
<input type=radio name=tabsetcode8 class=tabkotlin id=tab5code8 aria-controls=kotlincode8 onclick=handleClick(this); value=kotlin>
<label for=tab5code8>Kotlin</label><div class=tab-panels><section id=javacode8 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>
<span style=color:#586e75>// 打开新标签页并切换到新标签页
</span><span style=color:#586e75></span>driver<span style=color:#719e07>.</span>switchTo<span style=color:#719e07>().</span>newWindow<span style=color:#719e07>(</span>WindowType<span style=color:#719e07>.</span>TAB<span style=color:#719e07>);</span>

<span style=color:#586e75>// 打开一个新窗口并切换到新窗口
</span><span style=color:#586e75></span>driver<span style=color:#719e07>.</span>switchTo<span style=color:#719e07>().</span>newWindow<span style=color:#719e07>(</span>WindowType<span style=color:#719e07>.</span>WINDOW<span style=color:#719e07>);</span>
</code></pre></div></section><section id=pythoncode8 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>
<span style=color:#586e75># 打开新标签页并切换到新标签页</span>
driver<span style=color:#719e07>.</span>switch_to<span style=color:#719e07>.</span>new_window(<span style=color:#2aa198>&#39;tab&#39;</span>)

<span style=color:#586e75># 打开一个新窗口并切换到新窗口</span>
driver<span style=color:#719e07>.</span>switch_to<span style=color:#719e07>.</span>new_window(<span style=color:#2aa198>&#39;window&#39;</span>)
</code></pre></div></section><section id=csharpcode8 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>
<span style=color:#586e75>// 打开新标签页并切换到新标签页
</span><span style=color:#586e75></span>driver.SwitchTo().NewWindow(WindowType.Tab)

<span style=color:#586e75>// 打开一个新窗口并切换到新窗口
</span><span style=color:#586e75></span>driver.SwitchTo().NewWindow(WindowType.Window)
</code></pre></div></section><section id=rubycode8 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>
<span style=color:#586e75># 注意：ruby 中的 new_window 只打开一个新标签页(或)窗口，不会自动切换</span>
<span style=color:#586e75># 用户必须切换到新选项卡 (或) 新窗口</span>

<span style=color:#586e75># 打开新标签页并切换到新标签页</span>
driver<span style=color:#719e07>.</span>manage<span style=color:#719e07>.</span>new_window(<span style=color:#2aa198>:tab</span>)

<span style=color:#586e75># 打开一个新窗口并切换到新窗口</span>
driver<span style=color:#719e07>.</span>manage<span style=color:#719e07>.</span>new_window(<span style=color:#2aa198>:window</span>)
</code></pre></div></section><section id=javascriptcode8 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>
<span style=color:#586e75>// 打开新标签页并切换到新标签页
</span><span style=color:#586e75></span>await driver.switchTo().newWindow(<span style=color:#2aa198>&#39;tab&#39;</span>);

<span style=color:#586e75>// 打开一个新窗口并切换到新窗口
</span><span style=color:#586e75></span>await driver.switchTo().newWindow(<span style=color:#2aa198>&#39;window&#39;</span>);

</code></pre></div></section><section id=kotlincode8 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>
<span style=color:#586e75>// 打开新标签页并切换到新标签页
</span><span style=color:#586e75></span>driver.switchTo().newWindow(WindowType.TAB)

<span style=color:#586e75>// 打开一个新窗口并切换到新窗口
</span><span style=color:#586e75></span>driver.switchTo().newWindow(WindowType.WINDOW)
</code></pre></div></section></div></div><h3 id=关闭窗口或标签页>关闭窗口或标签页</h3><p>当你完成了一个窗口或标签页的工作时，_并且_它不是浏览器中最后一个打开的窗口或标签页时，你应该关闭它并切换回你之前使用的窗口。
假设您遵循了前一节中的代码示例，您将把前一个窗口句柄存储在一个变量中。把这些放在一起，你会得到:</p><div class=tabset><input type=radio name=tabsetcode9 class=tabjava id=tab0code9 aria-controls=javacode9 onclick=handleClick(this); value=java checked>
<label for=tab0code9>Java</label>
<input type=radio name=tabsetcode9 class=tabpython id=tab1code9 aria-controls=pythoncode9 onclick=handleClick(this); value=python>
<label for=tab1code9>Python</label>
<input type=radio name=tabsetcode9 class=tabcs id=tab2code9 aria-controls=cscode9 onclick=handleClick(this); value=cs>
<label for=tab2code9>C#</label>
<input type=radio name=tabsetcode9 class=tabruby id=tab3code9 aria-controls=rubycode9 onclick=handleClick(this); value=ruby>
<label for=tab3code9>Ruby</label>
<input type=radio name=tabsetcode9 class=tabjavascript id=tab4code9 aria-controls=javascriptcode9 onclick=handleClick(this); value=javascript>
<label for=tab4code9>JavaScript</label>
<input type=radio name=tabsetcode9 class=tabkotlin id=tab5code9 aria-controls=kotlincode9 onclick=handleClick(this); value=kotlin>
<label for=tab5code9>Kotlin</label><div class=tab-panels><section id=javacode9 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>
<span style=color:#586e75>//关闭标签页或窗口
</span><span style=color:#586e75></span>driver<span style=color:#719e07>.</span>close<span style=color:#719e07>();</span>

<span style=color:#586e75>//切回到之前的标签页或窗口
</span><span style=color:#586e75></span>driver<span style=color:#719e07>.</span>switchTo<span style=color:#719e07>().</span>window<span style=color:#719e07>(</span>originalWindow<span style=color:#719e07>);</span>
</code></pre></div></section><section id=pythoncode9 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>
<span style=color:#586e75>#关闭标签页或窗口</span>
driver<span style=color:#719e07>.</span>close()

<span style=color:#586e75>#切回到之前的标签页或窗口</span>
driver<span style=color:#719e07>.</span>switch_to<span style=color:#719e07>.</span>window(original_window)
</code></pre></div></section><section id=csharpcode9 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>
<span style=color:#586e75>//关闭标签页或窗口
</span><span style=color:#586e75></span>driver.Close();

<span style=color:#586e75>//切回到之前的标签页或窗口
</span><span style=color:#586e75></span>driver.SwitchTo().Window(originalWindow);
</code></pre></div></section><section id=rubycode9 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>
<span style=color:#586e75>#关闭标签页或窗口</span>
driver<span style=color:#719e07>.</span>close

<span style=color:#586e75>#切回到之前的标签页或窗口</span>
driver<span style=color:#719e07>.</span>switch_to<span style=color:#719e07>.</span>window original_window
</code></pre></div></section><section id=javascriptcode9 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>
<span style=color:#586e75>//关闭标签页或窗口
</span><span style=color:#586e75></span>await driver.close();

<span style=color:#586e75>//切回到之前的标签页或窗口
</span><span style=color:#586e75></span>await driver.switchTo().<span style=color:#b58900>window</span>(originalWindow);
</code></pre></div></section><section id=kotlincode9 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>
<span style=color:#586e75>//关闭标签页或窗口
</span><span style=color:#586e75></span>driver.close()

<span style=color:#586e75>//切回到之前的标签页或窗口
</span><span style=color:#586e75></span>driver.switchTo().window(originalWindow)

</code></pre></div></section></div></div><p>如果在关闭一个窗口后忘记切换回另一个窗口句柄，WebDriver 将在当前关闭的页面上执行，并触发一个
<strong>No Such Window Exception 无此窗口异常</strong>。必须切换回有效的窗口句柄才能继续执行。</p><h3 id=在会话结束时退出浏览器>在会话结束时退出浏览器</h3><p>当你完成了浏览器会话，你应该调用 quit 退出，而不是 close 关闭:<div class=tabset><input type=radio name=tabsetcode10 class=tabjava id=tab0code10 aria-controls=javacode10 onclick=handleClick(this); value=java checked>
<label for=tab0code10>Java</label>
<input type=radio name=tabsetcode10 class=tabpython id=tab1code10 aria-controls=pythoncode10 onclick=handleClick(this); value=python>
<label for=tab1code10>Python</label>
<input type=radio name=tabsetcode10 class=tabcs id=tab2code10 aria-controls=cscode10 onclick=handleClick(this); value=cs>
<label for=tab2code10>C#</label>
<input type=radio name=tabsetcode10 class=tabruby id=tab3code10 aria-controls=rubycode10 onclick=handleClick(this); value=ruby>
<label for=tab3code10>Ruby</label>
<input type=radio name=tabsetcode10 class=tabjavascript id=tab4code10 aria-controls=javascriptcode10 onclick=handleClick(this); value=javascript>
<label for=tab4code10>JavaScript</label>
<input type=radio name=tabsetcode10 class=tabkotlin id=tab5code10 aria-controls=kotlincode10 onclick=handleClick(this); value=kotlin>
<label for=tab5code10>Kotlin</label><div class=tab-panels><section id=javacode10 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>driver<span style=color:#719e07>.</span>quit<span style=color:#719e07>();</span></code></pre></div></section><section id=pythoncode10 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>driver<span style=color:#719e07>.</span>quit()</code></pre></div></section><section id=csharpcode10 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>driver.Quit();
</code></pre></div></section><section id=rubycode10 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>driver<span style=color:#719e07>.</span>quit</code></pre></div></section><section id=javascriptcode10 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>await driver.quit();
</code></pre></div></section><section id=kotlincode10 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>driver.quit()</code></pre></div></section></div></div></p><ul><li>退出将会<ul><li>关闭所有与 WebDriver 会话相关的窗口和选项卡</li><li>结束浏览器进程</li><li>结束后台驱动进程</li><li>通知 Selenium Grid 浏览器不再使用，以便可以由另一个会话使用它(如果您正在使用 Selenium Grid)</li></ul></li></ul><p>调用 quit() 失败将留下额外的后台进程和端口运行在机器上，这可能在以后导致一些问题。</p><p>有的测试框架提供了一些方法和注释，您可以在测试结束时放入 teardown() 方法中。</p><div class=tabset><input type=radio name=tabsetcode11 class=tabjava id=tab0code11 aria-controls=javacode11 onclick=handleClick(this); value=java checked>
<label for=tab0code11>Java</label>
<input type=radio name=tabsetcode11 class=tabpython id=tab1code11 aria-controls=pythoncode11 onclick=handleClick(this); value=python>
<label for=tab1code11>Python</label>
<input type=radio name=tabsetcode11 class=tabcs id=tab2code11 aria-controls=cscode11 onclick=handleClick(this); value=cs>
<label for=tab2code11>C#</label>
<input type=radio name=tabsetcode11 class=tabruby id=tab3code11 aria-controls=rubycode11 onclick=handleClick(this); value=ruby>
<label for=tab3code11>Ruby</label>
<input type=radio name=tabsetcode11 class=tabjavascript id=tab4code11 aria-controls=javascriptcode11 onclick=handleClick(this); value=javascript>
<label for=tab4code11>JavaScript</label>
<input type=radio name=tabsetcode11 class=tabkotlin id=tab5code11 aria-controls=kotlincode11 onclick=handleClick(this); value=kotlin>
<label for=tab5code11>Kotlin</label><div class=tab-panels><section id=javacode11 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>
<span style=color:#586e75>/**
</span><span style=color:#586e75>* 使用 JUnit 的例子
</span><span style=color:#586e75>* https://junit.org/junit5/docs/current/api/org/junit/jupiter/api/AfterAll.html
</span><span style=color:#586e75>  */</span>
  <span style=color:#268bd2>@AfterAll</span>
  <span style=color:#268bd2>public</span> <span style=color:#268bd2>static</span> <span style=color:#dc322f>void</span> <span style=color:#268bd2>tearDown</span><span style=color:#719e07>()</span> <span style=color:#719e07>{</span>driver<span style=color:#719e07>.</span>quit<span style=color:#719e07>();</span>
  <span style=color:#719e07>}</span>
  </code></pre></div></section><section id=pythoncode11 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>
<span style=color:#586e75># unittest teardown</span>
<span style=color:#586e75># https://docs.python.org/3/library/unittest.html?highlight=teardown#unittest.TestCase.tearDown</span>
<span style=color:#719e07>def</span> <span style=color:#268bd2>tearDown</span>(<span style=color:#268bd2>self</span>):
<span style=color:#268bd2>self</span><span style=color:#719e07>.</span>driver<span style=color:#719e07>.</span>quit()
</code></pre></div></section><section id=csharpcode11 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>
<span style=color:#586e75>/*
</span><span style=color:#586e75>使用 Visual Studio 的 UnitTesting 的例子
</span><span style=color:#586e75>https://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.aspx
</span><span style=color:#586e75>*/</span>
[TestCleanup]
<span style=color:#719e07>public</span> <span style=color:#719e07>void</span> TearDown()
{driver.Quit();
}
</code></pre></div></section><section id=rubycode11 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>
<span style=color:#586e75># UnitTest Teardown</span>
<span style=color:#586e75># https://www.rubydoc.info/github/test-unit/test-unit/Test/Unit/TestCase</span>
<span style=color:#719e07>def</span> <span style=color:#268bd2>teardown</span>
@driver<span style=color:#719e07>.</span>quit
<span style=color:#719e07>end</span>
</code></pre></div></section><section id=javascriptcode11 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>
<span style=color:#586e75>/**
</span><span style=color:#586e75>* 使用 Mocha 的例子
</span><span style=color:#586e75>* https://mochajs.org/#hooks
</span><span style=color:#586e75>  */</span>
  after(<span style=color:#2aa198>&#39;Tear down&#39;</span>, async <span style=color:#268bd2>function</span> () {await driver.quit();
  });
  
</code></pre></div></section><section id=kotlincode11 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>

<span style=color:#586e75>/**
</span><span style=color:#586e75>* 使用 JUnit 的例子
</span><span style=color:#586e75>* https://junit.org/junit5/docs/current/api/org/junit/jupiter/api/AfterAll.html
</span><span style=color:#586e75>  */</span>
  @AfterAll
  <span style=color:#719e07>fun</span> <span style=color:#268bd2>tearDown</span>() {driver.quit()
  }
  </code></pre></div></section></div></div><p>如果不在测试上下文中运行 WebDriver，您可以考虑使用 <code>try / finally</code>，这是大多数语言都提供的，
这样一个异常处理仍然可以清理 WebDriver 会话。</p><div class=tabset><input type=radio name=tabsetcode12 class=tabjava id=tab0code12 aria-controls=javacode12 onclick=handleClick(this); value=java checked>
<label for=tab0code12>Java</label>
<input type=radio name=tabsetcode12 class=tabpython id=tab1code12 aria-controls=pythoncode12 onclick=handleClick(this); value=python>
<label for=tab1code12>Python</label>
<input type=radio name=tabsetcode12 class=tabcs id=tab2code12 aria-controls=cscode12 onclick=handleClick(this); value=cs>
<label for=tab2code12>C#</label>
<input type=radio name=tabsetcode12 class=tabruby id=tab3code12 aria-controls=rubycode12 onclick=handleClick(this); value=ruby>
<label for=tab3code12>Ruby</label>
<input type=radio name=tabsetcode12 class=tabjavascript id=tab4code12 aria-controls=javascriptcode12 onclick=handleClick(this); value=javascript>
<label for=tab4code12>JavaScript</label>
<input type=radio name=tabsetcode12 class=tabkotlin id=tab5code12 aria-controls=kotlincode12 onclick=handleClick(this); value=kotlin>
<label for=tab5code12>Kotlin</label><div class=tab-panels><section id=javacode12 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>
<span style=color:#719e07>try</span> <span style=color:#719e07>{</span><span style=color:#586e75>//WebDriver 代码…} finally {driver.quit();
</span><span style=color:#586e75></span><span style=color:#719e07>}</span>
</code></pre></div></section><section id=pythoncode12 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>
<span style=color:#719e07>try</span>:
<span style=color:#586e75>#WebDriver 代码…</span>
<span style=color:#719e07>finally</span>:
driver<span style=color:#719e07>.</span>quit()
</code></pre></div></section><section id=csharpcode12 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>
<span style=color:#719e07>try</span> {<span style=color:#586e75>//WebDriver 代码…} finally {driver.Quit();
</span><span style=color:#586e75></span>}
</code></pre></div></section><section id=rubycode12 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>
<span style=color:#719e07>begin</span>
<span style=color:#586e75>#WebDriver 代码…</span>
<span style=color:#719e07>ensure</span>
driver<span style=color:#719e07>.</span>quit
<span style=color:#719e07>end</span>
</code></pre></div></section><section id=javascriptcode12 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>
<span style=color:#719e07>try</span> {<span style=color:#586e75>//WebDriver 代码…} finally {await driver.quit();
</span><span style=color:#586e75></span>}
</code></pre></div></section><section id=kotlincode12 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>
<span style=color:#719e07>try</span> {<span style=color:#586e75>//WebDriver 代码…} finally {driver.quit()
</span><span style=color:#586e75></span>}
</code></pre></div></section></div></div><p>Python 的 WebDriver 现在支持 Python 上下文管理器，当使用 with 关键字时，可以在执行结束时自动退出驱动程序。</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#719e07>with</span> webdriver<span style=color:#719e07>.</span>Firefox() <span style=color:#719e07>as</span> driver:
  <span style=color:#586e75># WebDriver 代码…</span>

<span style=color:#586e75># 在此缩进位置后 WebDriver 会自动退出</span>
</code></pre></div><h2 id=frames-and-iframes>Frames and Iframes</h2><p>框架是一种现在已被弃用的方法，用于从同一域中的多个文档构建站点布局。除非你使用的是 HTML5
之前的 webapp，否则你不太可能与他们合作。内嵌框架允许插入来自完全不同领域的文档，并且仍然经常使用。</p><p>如果您需要使用框架或 iframe, WebDriver 允许您以相同的方式使用它们。考虑 iframe 中的一个按钮。
如果我们使用浏览器开发工具检查元素，我们可能会看到以下内容:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=color:#268bd2>div</span> id<span style=color:#719e07>=</span><span style=color:#2aa198>&#34;modal&#34;</span>&gt;
  &lt;<span style=color:#268bd2>iframe</span> id<span style=color:#719e07>=</span><span style=color:#2aa198>&#34;buttonframe&#34;</span>name<span style=color:#719e07>=</span><span style=color:#2aa198>&#34;myframe&#34;</span>src<span style=color:#719e07>=</span><span style=color:#2aa198>&#34;https://seleniumhq.github.io&#34;</span>&gt;
   &lt;<span style=color:#268bd2>button</span>&gt;Click here&lt;/<span style=color:#268bd2>button</span>&gt;
 &lt;/<span style=color:#268bd2>iframe</span>&gt;
&lt;/<span style=color:#268bd2>div</span>&gt;
</code></pre></div><p>如果不是 iframe，我们可能会使用如下方式点击按钮:</p><div class=tabset><input type=radio name=tabsetcode13 class=tabjava id=tab0code13 aria-controls=javacode13 onclick=handleClick(this); value=java checked>
<label for=tab0code13>Java</label>
<input type=radio name=tabsetcode13 class=tabpython id=tab1code13 aria-controls=pythoncode13 onclick=handleClick(this); value=python>
<label for=tab1code13>Python</label>
<input type=radio name=tabsetcode13 class=tabcs id=tab2code13 aria-controls=cscode13 onclick=handleClick(this); value=cs>
<label for=tab2code13>C#</label>
<input type=radio name=tabsetcode13 class=tabruby id=tab3code13 aria-controls=rubycode13 onclick=handleClick(this); value=ruby>
<label for=tab3code13>Ruby</label>
<input type=radio name=tabsetcode13 class=tabjavascript id=tab4code13 aria-controls=javascriptcode13 onclick=handleClick(this); value=javascript>
<label for=tab4code13>JavaScript</label>
<input type=radio name=tabsetcode13 class=tabkotlin id=tab5code13 aria-controls=kotlincode13 onclick=handleClick(this); value=kotlin>
<label for=tab5code13>Kotlin</label><div class=tab-panels><section id=javacode13 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>
<span style=color:#586e75>// 这不会工作
</span><span style=color:#586e75></span>driver<span style=color:#719e07>.</span>findElement<span style=color:#719e07>(</span>By<span style=color:#719e07>.</span>tagName<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;button&#34;</span><span style=color:#719e07>)).</span>click<span style=color:#719e07>();</span>
</code></pre></div></section><section id=pythoncode13 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>
<span style=color:#586e75># 这不会工作</span>
driver<span style=color:#719e07>.</span>find_element(By<span style=color:#719e07>.</span>TAG_NAME, <span style=color:#2aa198>&#39;button&#39;</span>)<span style=color:#719e07>.</span>click()
</code></pre></div></section><section id=csharpcode13 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>
<span style=color:#586e75>// 这不会工作
</span><span style=color:#586e75></span>driver.FindElement(By.TagName(<span style=color:#2aa198>&#34;button&#34;</span>)).Click();
</code></pre></div></section><section id=rubycode13 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>
<span style=color:#586e75># 这不会工作</span>
driver<span style=color:#719e07>.</span>find_element(<span style=color:#2aa198>:tag_name</span>,<span style=color:#2aa198>&#39;button&#39;</span>)<span style=color:#719e07>.</span>click
</code></pre></div></section><section id=javascriptcode13 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>
<span style=color:#586e75>// 这不会工作
</span><span style=color:#586e75></span>await driver.findElement(By.css(<span style=color:#2aa198>&#39;button&#39;</span>)).click();
</code></pre></div></section><section id=kotlincode13 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>
<span style=color:#586e75>// 这不会工作
</span><span style=color:#586e75></span>driver.findElement(By.tagName(<span style=color:#2aa198>&#34;button&#34;</span>)).click()
</code></pre></div></section></div></div><p>但是，如果 iframe 之外没有按钮，那么您可能会得到一个 <em>no such element 无此元素</em> 的错误。
这是因为 Selenium 只知道顶层文档中的元素。为了与按钮进行交互，我们需要首先切换到框架，
这与切换窗口的方式类似。WebDriver 提供了三种切换到帧的方法。</p><h3 id=使用-webelement>使用 WebElement</h3><p>使用 WebElement 进行切换是最灵活的选择。您可以使用首选的选择器找到框架并切换到它。</p><div class=tabset><input type=radio name=tabsetcode14 class=tabjava id=tab0code14 aria-controls=javacode14 onclick=handleClick(this); value=java checked>
<label for=tab0code14>Java</label>
<input type=radio name=tabsetcode14 class=tabpython id=tab1code14 aria-controls=pythoncode14 onclick=handleClick(this); value=python>
<label for=tab1code14>Python</label>
<input type=radio name=tabsetcode14 class=tabcs id=tab2code14 aria-controls=cscode14 onclick=handleClick(this); value=cs>
<label for=tab2code14>C#</label>
<input type=radio name=tabsetcode14 class=tabruby id=tab3code14 aria-controls=rubycode14 onclick=handleClick(this); value=ruby>
<label for=tab3code14>Ruby</label>
<input type=radio name=tabsetcode14 class=tabjavascript id=tab4code14 aria-controls=javascriptcode14 onclick=handleClick(this); value=javascript>
<label for=tab4code14>JavaScript</label>
<input type=radio name=tabsetcode14 class=tabkotlin id=tab5code14 aria-controls=kotlincode14 onclick=handleClick(this); value=kotlin>
<label for=tab5code14>Kotlin</label><div class=tab-panels><section id=javacode14 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>
<span style=color:#586e75>// 存储网页元素
</span><span style=color:#586e75></span>WebElement iframe <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>findElement<span style=color:#719e07>(</span>By<span style=color:#719e07>.</span>cssSelector<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;#modal&gt;iframe&#34;</span><span style=color:#719e07>));</span>

<span style=color:#586e75>// 切换到 frame
</span><span style=color:#586e75></span>driver<span style=color:#719e07>.</span>switchTo<span style=color:#719e07>().</span>frame<span style=color:#719e07>(</span>iframe<span style=color:#719e07>);</span>

<span style=color:#586e75>// 现在可以点击按钮
</span><span style=color:#586e75></span>driver<span style=color:#719e07>.</span>findElement<span style=color:#719e07>(</span>By<span style=color:#719e07>.</span>tagName<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;button&#34;</span><span style=color:#719e07>)).</span>click<span style=color:#719e07>();</span>
</code></pre></div></section><section id=pythoncode14 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>
<span style=color:#586e75># 存储网页元素</span>
iframe <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>find_element(By<span style=color:#719e07>.</span>CSS_SELECTOR, <span style=color:#2aa198>&#34;#modal &gt; iframe&#34;</span>)

<span style=color:#586e75># 切换到选择的 iframe</span>
driver<span style=color:#719e07>.</span>switch_to<span style=color:#719e07>.</span>frame(iframe)

<span style=color:#586e75># 单击按钮</span>
driver<span style=color:#719e07>.</span>find_element(By<span style=color:#719e07>.</span>TAG_NAME, <span style=color:#2aa198>&#39;button&#39;</span>)<span style=color:#719e07>.</span>click()
</code></pre></div></section><section id=csharpcode14 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>
<span style=color:#586e75>// 存储网页元素
</span><span style=color:#586e75></span>IWebElement iframe = driver.FindElement(By.CssSelector(<span style=color:#2aa198>&#34;#modal&gt;iframe&#34;</span>));

<span style=color:#586e75>// 切换到 frame
</span><span style=color:#586e75></span>driver.SwitchTo().Frame(iframe);

<span style=color:#586e75>// 现在可以点击按钮
</span><span style=color:#586e75></span>driver.FindElement(By.TagName(<span style=color:#2aa198>&#34;button&#34;</span>)).Click();
</code></pre></div></section><section id=rubycode14 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>
<span style=color:#586e75># Store iframe web element</span>
iframe <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>find_element(<span style=color:#2aa198>:css</span>,<span style=color:#2aa198>&#39;#modal&gt; iframe&#39;</span>)

<span style=color:#586e75># 切换到 frame</span>
driver<span style=color:#719e07>.</span>switch_to<span style=color:#719e07>.</span>frame iframe

<span style=color:#586e75># 单击按钮</span>
driver<span style=color:#719e07>.</span>find_element(<span style=color:#2aa198>:tag_name</span>,<span style=color:#2aa198>&#39;button&#39;</span>)<span style=color:#719e07>.</span>click
</code></pre></div></section><section id=javascriptcode14 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>
<span style=color:#586e75>// 存储网页元素
</span><span style=color:#586e75></span><span style=color:#268bd2>const</span> iframe <span style=color:#719e07>=</span> driver.findElement(By.css(<span style=color:#2aa198>&#39;#modal&gt; iframe&#39;</span>));

<span style=color:#586e75>// 切换到 frame
</span><span style=color:#586e75></span>await driver.switchTo().frame(iframe);

<span style=color:#586e75>// 现在可以点击按钮
</span><span style=color:#586e75></span>await driver.findElement(By.css(<span style=color:#2aa198>&#39;button&#39;</span>)).click();
</code></pre></div></section><section id=kotlincode14 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>
<span style=color:#586e75>// 存储网页元素
</span><span style=color:#586e75></span><span style=color:#719e07>val</span> iframe = driver.findElement(By.cssSelector(<span style=color:#2aa198>&#34;#modal&gt;iframe&#34;</span>))

<span style=color:#586e75>// 切换到 frame
</span><span style=color:#586e75></span>driver.switchTo().frame(iframe)

<span style=color:#586e75>// 现在可以点击按钮
</span><span style=color:#586e75></span>driver.findElement(By.tagName(<span style=color:#2aa198>&#34;button&#34;</span>)).click()
</code></pre></div></section></div></div><h3 id=使用-name-或-id>使用 name 或 id</h3><p>如果您的 frame 或 iframe 具有 id 或 name 属性，则可以使用该属性。如果名称或 id 在页面上不是唯一的，
那么将切换到找到的第一个。</p><div class=tabset><input type=radio name=tabsetcode15 class=tabjava id=tab0code15 aria-controls=javacode15 onclick=handleClick(this); value=java checked>
<label for=tab0code15>Java</label>
<input type=radio name=tabsetcode15 class=tabpython id=tab1code15 aria-controls=pythoncode15 onclick=handleClick(this); value=python>
<label for=tab1code15>Python</label>
<input type=radio name=tabsetcode15 class=tabcs id=tab2code15 aria-controls=cscode15 onclick=handleClick(this); value=cs>
<label for=tab2code15>C#</label>
<input type=radio name=tabsetcode15 class=tabruby id=tab3code15 aria-controls=rubycode15 onclick=handleClick(this); value=ruby>
<label for=tab3code15>Ruby</label>
<input type=radio name=tabsetcode15 class=tabjavascript id=tab4code15 aria-controls=javascriptcode15 onclick=handleClick(this); value=javascript>
<label for=tab4code15>JavaScript</label>
<input type=radio name=tabsetcode15 class=tabkotlin id=tab5code15 aria-controls=kotlincode15 onclick=handleClick(this); value=kotlin>
<label for=tab5code15>Kotlin</label><div class=tab-panels><section id=javacode15 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>
<span style=color:#586e75>// 使用 ID
</span><span style=color:#586e75></span>driver<span style=color:#719e07>.</span>switchTo<span style=color:#719e07>().</span>frame<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;buttonframe&#34;</span><span style=color:#719e07>);</span>

<span style=color:#586e75>// 或者使用 name 代替
</span><span style=color:#586e75></span>driver<span style=color:#719e07>.</span>switchTo<span style=color:#719e07>().</span>frame<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;myframe&#34;</span><span style=color:#719e07>);</span>

<span style=color:#586e75>// 现在可以点击按钮
</span><span style=color:#586e75></span>driver<span style=color:#719e07>.</span>findElement<span style=color:#719e07>(</span>By<span style=color:#719e07>.</span>tagName<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;button&#34;</span><span style=color:#719e07>)).</span>click<span style=color:#719e07>();</span>
</code></pre></div></section><section id=pythoncode15 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>
<span style=color:#586e75># 通过 id 切换框架</span>
driver<span style=color:#719e07>.</span>switch_to<span style=color:#719e07>.</span>frame(<span style=color:#2aa198>&#39;buttonframe&#39;</span>)

<span style=color:#586e75># 单击按钮</span>
driver<span style=color:#719e07>.</span>find_element(By<span style=color:#719e07>.</span>TAG_NAME, <span style=color:#2aa198>&#39;button&#39;</span>)<span style=color:#719e07>.</span>click()
</code></pre></div></section><section id=csharpcode15 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>
<span style=color:#586e75>// 使用 ID
</span><span style=color:#586e75></span>driver.SwitchTo().Frame(<span style=color:#2aa198>&#34;buttonframe&#34;</span>);

<span style=color:#586e75>// 或者使用 name 代替
</span><span style=color:#586e75></span>driver.SwitchTo().Frame(<span style=color:#2aa198>&#34;myframe&#34;</span>);

<span style=color:#586e75>// 现在可以点击按钮
</span><span style=color:#586e75></span>driver.FindElement(By.TagName(<span style=color:#2aa198>&#34;button&#34;</span>)).Click();
</code></pre></div></section><section id=rubycode15 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>
<span style=color:#586e75># Switch by ID</span>
driver<span style=color:#719e07>.</span>switch_to<span style=color:#719e07>.</span>frame <span style=color:#2aa198>&#39;buttonframe&#39;</span>

<span style=color:#586e75># 单击按钮</span>
driver<span style=color:#719e07>.</span>find_element(<span style=color:#2aa198>:tag_name</span>,<span style=color:#2aa198>&#39;button&#39;</span>)<span style=color:#719e07>.</span>click
</code></pre></div></section><section id=javascriptcode15 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>
<span style=color:#586e75>// 使用 ID
</span><span style=color:#586e75></span>await driver.switchTo().frame(<span style=color:#2aa198>&#39;buttonframe&#39;</span>);

<span style=color:#586e75>// 或者使用 name 代替
</span><span style=color:#586e75></span>await driver.switchTo().frame(<span style=color:#2aa198>&#39;myframe&#39;</span>);

<span style=color:#586e75>// 现在可以点击按钮
</span><span style=color:#586e75></span>await driver.findElement(By.css(<span style=color:#2aa198>&#39;button&#39;</span>)).click();
</code></pre></div></section><section id=kotlincode15 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>
<span style=color:#586e75>// 使用 ID
</span><span style=color:#586e75></span>driver.switchTo().frame(<span style=color:#2aa198>&#34;buttonframe&#34;</span>)

<span style=color:#586e75>// 或者使用 name 代替
</span><span style=color:#586e75></span>driver.switchTo().frame(<span style=color:#2aa198>&#34;myframe&#34;</span>)

<span style=color:#586e75>// 现在可以点击按钮
</span><span style=color:#586e75></span>driver.findElement(By.tagName(<span style=color:#2aa198>&#34;button&#34;</span>)).click()
</code></pre></div></section></div></div><h3 id=使用索引>使用索引</h3><p>还可以使用frame的索引，
例如可以使用JavaScript中的
<em>window.frames</em> 进行查询.</p><div class=tabset><input type=radio name=tabsetcode16 class=tabjava id=tab0code16 aria-controls=javacode16 onclick=handleClick(this); value=java checked>
<label for=tab0code16>Java</label>
<input type=radio name=tabsetcode16 class=tabpython id=tab1code16 aria-controls=pythoncode16 onclick=handleClick(this); value=python>
<label for=tab1code16>Python</label>
<input type=radio name=tabsetcode16 class=tabcs id=tab2code16 aria-controls=cscode16 onclick=handleClick(this); value=cs>
<label for=tab2code16>C#</label>
<input type=radio name=tabsetcode16 class=tabruby id=tab3code16 aria-controls=rubycode16 onclick=handleClick(this); value=ruby>
<label for=tab3code16>Ruby</label>
<input type=radio name=tabsetcode16 class=tabjavascript id=tab4code16 aria-controls=javascriptcode16 onclick=handleClick(this); value=javascript>
<label for=tab4code16>JavaScript</label>
<input type=radio name=tabsetcode16 class=tabkotlin id=tab5code16 aria-controls=kotlincode16 onclick=handleClick(this); value=kotlin>
<label for=tab5code16>Kotlin</label><div class=tab-panels><section id=javacode16 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>
<span style=color:#586e75>// 切换到第 2 个框架
</span><span style=color:#586e75></span>driver<span style=color:#719e07>.</span>switchTo<span style=color:#719e07>().</span>frame<span style=color:#719e07>(</span>1<span style=color:#719e07>);</span>
</code></pre></div></section><section id=rubycode16 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>
<span style=color:#586e75># 切换到第 2 个框架</span>
driver<span style=color:#719e07>.</span>switch_to<span style=color:#719e07>.</span>frame(<span style=color:#2aa198>1</span>)
</code></pre></div></section><section id=csharpcode16 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>
<span style=color:#586e75>// 切换到第 2 个框架
</span><span style=color:#586e75></span>driver.SwitchTo().Frame(<span style=color:#2aa198>1</span>);
</code></pre></div></section><section id=pythoncode16 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>
<span style=color:#586e75># 基于索引切换到第 2 个 iframe</span>
iframe <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>find_elements_by_tag_name(<span style=color:#2aa198>&#39;iframe&#39;</span>)[<span style=color:#2aa198>1</span>]

<span style=color:#586e75># 切换到选择的 iframe</span>
driver<span style=color:#719e07>.</span>switch_to<span style=color:#719e07>.</span>frame(iframe)
</code></pre></div></section><section id=javascriptcode16 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>
<span style=color:#586e75>// 切换到第 2 个框架
</span><span style=color:#586e75></span>await driver.switchTo().frame(<span style=color:#2aa198>1</span>);
</code></pre></div></section><section id=kotlincode16 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>
<span style=color:#586e75>// 切换到第 2 个框架
</span><span style=color:#586e75></span>driver.switchTo().frame(<span style=color:#2aa198>1</span>)
</code></pre></div></section></div></div><h3 id=离开框架>离开框架</h3><p>离开 iframe 或 frameset，切换回默认内容，如下所示:</p><div class=tabset><input type=radio name=tabsetcode17 class=tabjava id=tab0code17 aria-controls=javacode17 onclick=handleClick(this); value=java checked>
<label for=tab0code17>Java</label>
<input type=radio name=tabsetcode17 class=tabpython id=tab1code17 aria-controls=pythoncode17 onclick=handleClick(this); value=python>
<label for=tab1code17>Python</label>
<input type=radio name=tabsetcode17 class=tabcs id=tab2code17 aria-controls=cscode17 onclick=handleClick(this); value=cs>
<label for=tab2code17>C#</label>
<input type=radio name=tabsetcode17 class=tabruby id=tab3code17 aria-controls=rubycode17 onclick=handleClick(this); value=ruby>
<label for=tab3code17>Ruby</label>
<input type=radio name=tabsetcode17 class=tabjavascript id=tab4code17 aria-controls=javascriptcode17 onclick=handleClick(this); value=javascript>
<label for=tab4code17>JavaScript</label>
<input type=radio name=tabsetcode17 class=tabkotlin id=tab5code17 aria-controls=kotlincode17 onclick=handleClick(this); value=kotlin>
<label for=tab5code17>Kotlin</label><div class=tab-panels><section id=javacode17 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>
<span style=color:#586e75>// 回到顶层
</span><span style=color:#586e75></span>driver<span style=color:#719e07>.</span>switchTo<span style=color:#719e07>().</span>defaultContent<span style=color:#719e07>();</span>
</code></pre></div></section><section id=pythoncode17 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>
<span style=color:#586e75># 切回到默认内容</span>
driver<span style=color:#719e07>.</span>switch_to<span style=color:#719e07>.</span>default_content()
</code></pre></div></section><section id=csharpcode17 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>
<span style=color:#586e75>// 回到顶层
</span><span style=color:#586e75></span>driver.SwitchTo().DefaultContent();
</code></pre></div></section><section id=rubycode17 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>
<span style=color:#586e75># 回到顶层</span>
driver<span style=color:#719e07>.</span>switch_to<span style=color:#719e07>.</span>default_content
</code></pre></div></section><section id=javascriptcode17 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>
<span style=color:#586e75>// 回到顶层
</span><span style=color:#586e75></span>await driver.switchTo().defaultContent();
</code></pre></div></section><section id=kotlincode17 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>
<span style=color:#586e75>// 回到顶层
</span><span style=color:#586e75></span>driver.switchTo().defaultContent()
</code></pre></div></section></div></div><h2 id=窗口管理>窗口管理</h2><p>屏幕分辨率会影响 web 应用程序的呈现方式，因此 WebDriver 提供了移动和调整浏览器窗口大小的机制。</p><h3 id=获取窗口大小>获取窗口大小</h3><p>获取浏览器窗口的大小(以像素为单位)。</p><div class=tabset><input type=radio name=tabsetcode18 class=tabjava id=tab0code18 aria-controls=javacode18 onclick=handleClick(this); value=java checked>
<label for=tab0code18>Java</label>
<input type=radio name=tabsetcode18 class=tabpython id=tab1code18 aria-controls=pythoncode18 onclick=handleClick(this); value=python>
<label for=tab1code18>Python</label>
<input type=radio name=tabsetcode18 class=tabcs id=tab2code18 aria-controls=cscode18 onclick=handleClick(this); value=cs>
<label for=tab2code18>C#</label>
<input type=radio name=tabsetcode18 class=tabruby id=tab3code18 aria-controls=rubycode18 onclick=handleClick(this); value=ruby>
<label for=tab3code18>Ruby</label>
<input type=radio name=tabsetcode18 class=tabjavascript id=tab4code18 aria-controls=javascriptcode18 onclick=handleClick(this); value=javascript>
<label for=tab4code18>JavaScript</label>
<input type=radio name=tabsetcode18 class=tabkotlin id=tab5code18 aria-controls=kotlincode18 onclick=handleClick(this); value=kotlin>
<label for=tab5code18>Kotlin</label><div class=tab-panels><section id=javacode18 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>
<span style=color:#586e75>// 分别获取每个尺寸
</span><span style=color:#586e75></span><span style=color:#dc322f>int</span> width <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>manage<span style=color:#719e07>().</span>window<span style=color:#719e07>().</span>getSize<span style=color:#719e07>().</span>getWidth<span style=color:#719e07>();</span>
<span style=color:#dc322f>int</span> height <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>manage<span style=color:#719e07>().</span>window<span style=color:#719e07>().</span>getSize<span style=color:#719e07>().</span>getHeight<span style=color:#719e07>();</span>

<span style=color:#586e75>// 或者存储尺寸并在以后查询它们
</span><span style=color:#586e75></span>Dimension size <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>manage<span style=color:#719e07>().</span>window<span style=color:#719e07>().</span>getSize<span style=color:#719e07>();</span>
<span style=color:#dc322f>int</span> width1 <span style=color:#719e07>=</span> size<span style=color:#719e07>.</span>getWidth<span style=color:#719e07>();</span>
<span style=color:#dc322f>int</span> height1 <span style=color:#719e07>=</span> size<span style=color:#719e07>.</span>getHeight<span style=color:#719e07>();</span>
</code></pre></div></section><section id=pythoncode18 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>
<span style=color:#586e75># 分别获取每个尺寸</span>
width <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>get_window_size()<span style=color:#719e07>.</span>get(<span style=color:#2aa198>&#34;width&#34;</span>)
height <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>get_window_size()<span style=color:#719e07>.</span>get(<span style=color:#2aa198>&#34;height&#34;</span>)

<span style=color:#586e75># 或者存储尺寸并在以后查询它们</span>
size <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>get_window_size()
width1 <span style=color:#719e07>=</span> size<span style=color:#719e07>.</span>get(<span style=color:#2aa198>&#34;width&#34;</span>)
height1 <span style=color:#719e07>=</span> size<span style=color:#719e07>.</span>get(<span style=color:#2aa198>&#34;height&#34;</span>)
</code></pre></div></section><section id=csharpcode18 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>
<span style=color:#586e75>// 分别获取每个尺寸
</span><span style=color:#586e75></span><span style=color:#dc322f>int</span> width = driver.Manage().Window.Size.Width;
<span style=color:#dc322f>int</span> height = driver.Manage().Window.Size.Height;

<span style=color:#586e75>// 或者存储尺寸并在以后查询它们
</span><span style=color:#586e75></span>System.Drawing.Size size = driver.Manage().Window.Size;
<span style=color:#dc322f>int</span> width1 = size.Width;
<span style=color:#dc322f>int</span> height1 = size.Height;
</code></pre></div></section><section id=rubycode18 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>
<span style=color:#586e75># 分别获取每个尺寸</span>
width <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>manage<span style=color:#719e07>.</span>window<span style=color:#719e07>.</span>size<span style=color:#719e07>.</span>width
height <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>manage<span style=color:#719e07>.</span>window<span style=color:#719e07>.</span>size<span style=color:#719e07>.</span>height

<span style=color:#586e75># 或者存储尺寸并在以后查询它们</span>
size <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>manage<span style=color:#719e07>.</span>window<span style=color:#719e07>.</span>size
width1 <span style=color:#719e07>=</span> size<span style=color:#719e07>.</span>width
height1 <span style=color:#719e07>=</span> size<span style=color:#719e07>.</span>height
</code></pre></div></section><section id=javascriptcode18 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>
<span style=color:#586e75>// 分别获取每个尺寸
</span><span style=color:#586e75></span><span style=color:#268bd2>const</span> {width, height} <span style=color:#719e07>=</span> await driver.manage().<span style=color:#b58900>window</span>().getRect();

<span style=color:#586e75>// 或者存储尺寸并在以后查询它们
</span><span style=color:#586e75></span><span style=color:#268bd2>const</span> rect <span style=color:#719e07>=</span> await driver.manage().<span style=color:#b58900>window</span>().getRect();
<span style=color:#268bd2>const</span> width1 <span style=color:#719e07>=</span> rect.width;
<span style=color:#268bd2>const</span> height1 <span style=color:#719e07>=</span> rect.height;
</code></pre></div></section><section id=kotlincode18 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>
<span style=color:#586e75>// 分别获取每个尺寸
</span><span style=color:#586e75></span><span style=color:#719e07>val</span> width = driver.manage().window().size.width
<span style=color:#719e07>val</span> height = driver.manage().window().size.height

<span style=color:#586e75>// 或者存储尺寸并在以后查询它们
</span><span style=color:#586e75></span><span style=color:#719e07>val</span> size = driver.manage().window().size
<span style=color:#719e07>val</span> width1 = size.width
<span style=color:#719e07>val</span> height1 = size.height
</code></pre></div></section></div></div><h3 id=设置窗口大小>设置窗口大小</h3><p>恢复窗口并设置窗口大小。<div class=tabset><input type=radio name=tabsetcode19 class=tabjava id=tab0code19 aria-controls=javacode19 onclick=handleClick(this); value=java checked>
<label for=tab0code19>Java</label>
<input type=radio name=tabsetcode19 class=tabpython id=tab1code19 aria-controls=pythoncode19 onclick=handleClick(this); value=python>
<label for=tab1code19>Python</label>
<input type=radio name=tabsetcode19 class=tabcs id=tab2code19 aria-controls=cscode19 onclick=handleClick(this); value=cs>
<label for=tab2code19>C#</label>
<input type=radio name=tabsetcode19 class=tabruby id=tab3code19 aria-controls=rubycode19 onclick=handleClick(this); value=ruby>
<label for=tab3code19>Ruby</label>
<input type=radio name=tabsetcode19 class=tabjavascript id=tab4code19 aria-controls=javascriptcode19 onclick=handleClick(this); value=javascript>
<label for=tab4code19>JavaScript</label>
<input type=radio name=tabsetcode19 class=tabkotlin id=tab5code19 aria-controls=kotlincode19 onclick=handleClick(this); value=kotlin>
<label for=tab5code19>Kotlin</label><div class=tab-panels><section id=javacode19 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>driver<span style=color:#719e07>.</span>manage<span style=color:#719e07>().</span>window<span style=color:#719e07>().</span>setSize<span style=color:#719e07>(</span><span style=color:#719e07>new</span> Dimension<span style=color:#719e07>(</span>1024<span style=color:#719e07>,</span> 768<span style=color:#719e07>));</span></code></pre></div></section><section id=pythoncode19 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>driver<span style=color:#719e07>.</span>set_window_size(<span style=color:#2aa198>1024</span>, <span style=color:#2aa198>768</span>)</code></pre></div></section><section id=csharpcode19 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>driver.Manage().Window.Size = <span style=color:#719e07>new</span> Size(<span style=color:#2aa198>1024</span>, <span style=color:#2aa198>768</span>);
</code></pre></div></section><section id=rubycode19 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>driver<span style=color:#719e07>.</span>manage<span style=color:#719e07>.</span>window<span style=color:#719e07>.</span>resize_to(<span style=color:#2aa198>1024</span>,<span style=color:#2aa198>768</span>)</code></pre></div></section><section id=javascriptcode19 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>await driver.manage().<span style=color:#b58900>window</span>().setRect({width<span style=color:#719e07>:</span> <span style=color:#2aa198>1024</span>, height<span style=color:#719e07>:</span> <span style=color:#2aa198>768</span>});
</code></pre></div></section><section id=kotlincode19 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>driver.manage().window().size = Dimension(<span style=color:#2aa198>1024</span>, <span style=color:#2aa198>768</span>)</code></pre></div></section></div></div></p><h3 id=得到窗口的位置>得到窗口的位置</h3><p>获取浏览器窗口左上角的坐标。</p><div class=tabset><input type=radio name=tabsetcode20 class=tabjava id=tab0code20 aria-controls=javacode20 onclick=handleClick(this); value=java checked>
<label for=tab0code20>Java</label>
<input type=radio name=tabsetcode20 class=tabpython id=tab1code20 aria-controls=pythoncode20 onclick=handleClick(this); value=python>
<label for=tab1code20>Python</label>
<input type=radio name=tabsetcode20 class=tabcs id=tab2code20 aria-controls=cscode20 onclick=handleClick(this); value=cs>
<label for=tab2code20>C#</label>
<input type=radio name=tabsetcode20 class=tabruby id=tab3code20 aria-controls=rubycode20 onclick=handleClick(this); value=ruby>
<label for=tab3code20>Ruby</label>
<input type=radio name=tabsetcode20 class=tabjavascript id=tab4code20 aria-controls=javascriptcode20 onclick=handleClick(this); value=javascript>
<label for=tab4code20>JavaScript</label>
<input type=radio name=tabsetcode20 class=tabkotlin id=tab5code20 aria-controls=kotlincode20 onclick=handleClick(this); value=kotlin>
<label for=tab5code20>Kotlin</label><div class=tab-panels><section id=javacode20 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>
<span style=color:#586e75>// 分别获取每个尺寸
</span><span style=color:#586e75></span><span style=color:#dc322f>int</span> x <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>manage<span style=color:#719e07>().</span>window<span style=color:#719e07>().</span>getPosition<span style=color:#719e07>().</span>getX<span style=color:#719e07>();</span>
<span style=color:#dc322f>int</span> y <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>manage<span style=color:#719e07>().</span>window<span style=color:#719e07>().</span>getPosition<span style=color:#719e07>().</span>getY<span style=color:#719e07>();</span>

<span style=color:#586e75>// 或者存储尺寸并在以后查询它们
</span><span style=color:#586e75></span>Point position <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>manage<span style=color:#719e07>().</span>window<span style=color:#719e07>().</span>getPosition<span style=color:#719e07>();</span>
<span style=color:#dc322f>int</span> x1 <span style=color:#719e07>=</span> position<span style=color:#719e07>.</span>getX<span style=color:#719e07>();</span>
<span style=color:#dc322f>int</span> y1 <span style=color:#719e07>=</span> position<span style=color:#719e07>.</span>getY<span style=color:#719e07>();</span>
</code></pre></div></section><section id=pythoncode20 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>
<span style=color:#586e75># 分别获取每个尺寸</span>
x <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>get_window_position()<span style=color:#719e07>.</span>get(<span style=color:#2aa198>&#39;x&#39;</span>)
y <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>get_window_position()<span style=color:#719e07>.</span>get(<span style=color:#2aa198>&#39;y&#39;</span>)

<span style=color:#586e75># 或者存储尺寸并在以后查询它们</span>
position <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>get_window_position()
x1 <span style=color:#719e07>=</span> position<span style=color:#719e07>.</span>get(<span style=color:#2aa198>&#39;x&#39;</span>)
y1 <span style=color:#719e07>=</span> position<span style=color:#719e07>.</span>get(<span style=color:#2aa198>&#39;y&#39;</span>)
</code></pre></div></section><section id=csharpcode20 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>
<span style=color:#586e75>// 分别获取每个尺寸
</span><span style=color:#586e75></span><span style=color:#dc322f>int</span> x = driver.Manage().Window.Position.X;
<span style=color:#dc322f>int</span> y = driver.Manage().Window.Position.Y;

<span style=color:#586e75>// 或者存储尺寸并在以后查询它们
</span><span style=color:#586e75></span>Point position = driver.Manage().Window.Position;
<span style=color:#dc322f>int</span> x1 = position.X;
<span style=color:#dc322f>int</span> y1 = position.Y;
</code></pre></div></section><section id=rubycode20 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>
<span style=color:#586e75>#Access each dimension individually</span>
x <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>manage<span style=color:#719e07>.</span>window<span style=color:#719e07>.</span>position<span style=color:#719e07>.</span>x
y <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>manage<span style=color:#719e07>.</span>window<span style=color:#719e07>.</span>position<span style=color:#719e07>.</span>y

<span style=color:#586e75># Or store the dimensions and query them later</span>
rect  <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>manage<span style=color:#719e07>.</span>window<span style=color:#719e07>.</span>rect
x1 <span style=color:#719e07>=</span> rect<span style=color:#719e07>.</span>x
y1 <span style=color:#719e07>=</span> rect<span style=color:#719e07>.</span>y
</code></pre></div></section><section id=javascriptcode20 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>
<span style=color:#586e75>// 分别获取每个尺寸
</span><span style=color:#586e75></span><span style=color:#268bd2>const</span> {x, y} <span style=color:#719e07>=</span> await driver.manage().<span style=color:#b58900>window</span>().getRect();

<span style=color:#586e75>// 或者存储尺寸并在以后查询它们
</span><span style=color:#586e75></span><span style=color:#268bd2>const</span> rect <span style=color:#719e07>=</span> await driver.manage().<span style=color:#b58900>window</span>().getRect();
<span style=color:#268bd2>const</span> x1 <span style=color:#719e07>=</span> rect.x;
<span style=color:#268bd2>const</span> y1 <span style=color:#719e07>=</span> rect.y;
</code></pre></div></section><section id=kotlincode20 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>
<span style=color:#586e75>// 分别获取每个尺寸
</span><span style=color:#586e75></span><span style=color:#719e07>val</span> x = driver.manage().window().position.x
<span style=color:#719e07>val</span> y = driver.manage().window().position.y

<span style=color:#586e75>// 或者存储尺寸并在以后查询它们
</span><span style=color:#586e75></span><span style=color:#719e07>val</span> position = driver.manage().window().position
<span style=color:#719e07>val</span> x1 = position.x
<span style=color:#719e07>val</span> y1 = position.y

</code></pre></div></section></div></div><h2 id=设置窗口位置>设置窗口位置</h2><p>将窗口移动到设定的位置。</p><div class=tabset><input type=radio name=tabsetcode21 class=tabjava id=tab0code21 aria-controls=javacode21 onclick=handleClick(this); value=java checked>
<label for=tab0code21>Java</label>
<input type=radio name=tabsetcode21 class=tabpython id=tab1code21 aria-controls=pythoncode21 onclick=handleClick(this); value=python>
<label for=tab1code21>Python</label>
<input type=radio name=tabsetcode21 class=tabcs id=tab2code21 aria-controls=cscode21 onclick=handleClick(this); value=cs>
<label for=tab2code21>C#</label>
<input type=radio name=tabsetcode21 class=tabruby id=tab3code21 aria-controls=rubycode21 onclick=handleClick(this); value=ruby>
<label for=tab3code21>Ruby</label>
<input type=radio name=tabsetcode21 class=tabjavascript id=tab4code21 aria-controls=javascriptcode21 onclick=handleClick(this); value=javascript>
<label for=tab4code21>JavaScript</label>
<input type=radio name=tabsetcode21 class=tabkotlin id=tab5code21 aria-controls=kotlincode21 onclick=handleClick(this); value=kotlin>
<label for=tab5code21>Kotlin</label><div class=tab-panels><section id=javacode21 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>
<span style=color:#586e75>// 将窗口移动到主显示器的左上角
</span><span style=color:#586e75></span>driver<span style=color:#719e07>.</span>manage<span style=color:#719e07>().</span>window<span style=color:#719e07>().</span>setPosition<span style=color:#719e07>(</span><span style=color:#719e07>new</span> Point<span style=color:#719e07>(</span>0<span style=color:#719e07>,</span> 0<span style=color:#719e07>));</span>
</code></pre></div></section><section id=pythoncode21 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>
<span style=color:#586e75># 将窗口移动到主显示器的左上角</span>
driver<span style=color:#719e07>.</span>set_window_position(<span style=color:#2aa198>0</span>, <span style=color:#2aa198>0</span>)
</code></pre></div></section><section id=csharpcode21 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>
<span style=color:#586e75>// 将窗口移动到主显示器的左上角
</span><span style=color:#586e75></span>driver.Manage().Window.Position = <span style=color:#719e07>new</span> Point(<span style=color:#2aa198>0</span>, <span style=color:#2aa198>0</span>);
</code></pre></div></section><section id=rubycode21 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>
driver<span style=color:#719e07>.</span>manage<span style=color:#719e07>.</span>window<span style=color:#719e07>.</span>move_to(<span style=color:#2aa198>0</span>,<span style=color:#2aa198>0</span>)
</code></pre></div></section><section id=javascriptcode21 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>
<span style=color:#586e75>// 将窗口移动到主显示器的左上角
</span><span style=color:#586e75></span>await driver.manage().<span style=color:#b58900>window</span>().setRect({x<span style=color:#719e07>:</span> <span style=color:#2aa198>0</span>, y<span style=color:#719e07>:</span> <span style=color:#2aa198>0</span>});
</code></pre></div></section><section id=kotlincode21 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>
<span style=color:#586e75>// 将窗口移动到主显示器的左上角
</span><span style=color:#586e75></span>driver.manage().window().position = Point(<span style=color:#2aa198>0</span>,<span style=color:#2aa198>0</span>)
</code></pre></div></section></div></div><h3 id=最大化窗口>最大化窗口</h3><p>扩大窗口。对于大多数操作系统，窗口将填满屏幕，而不会阻挡操作系统自己的菜单和工具栏。</p><div class=tabset><input type=radio name=tabsetcode22 class=tabjava id=tab0code22 aria-controls=javacode22 onclick=handleClick(this); value=java checked>
<label for=tab0code22>Java</label>
<input type=radio name=tabsetcode22 class=tabpython id=tab1code22 aria-controls=pythoncode22 onclick=handleClick(this); value=python>
<label for=tab1code22>Python</label>
<input type=radio name=tabsetcode22 class=tabcs id=tab2code22 aria-controls=cscode22 onclick=handleClick(this); value=cs>
<label for=tab2code22>C#</label>
<input type=radio name=tabsetcode22 class=tabruby id=tab3code22 aria-controls=rubycode22 onclick=handleClick(this); value=ruby>
<label for=tab3code22>Ruby</label>
<input type=radio name=tabsetcode22 class=tabjavascript id=tab4code22 aria-controls=javascriptcode22 onclick=handleClick(this); value=javascript>
<label for=tab4code22>JavaScript</label>
<input type=radio name=tabsetcode22 class=tabkotlin id=tab5code22 aria-controls=kotlincode22 onclick=handleClick(this); value=kotlin>
<label for=tab5code22>Kotlin</label><div class=tab-panels><section id=javacode22 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>driver<span style=color:#719e07>.</span>manage<span style=color:#719e07>().</span>window<span style=color:#719e07>().</span>maximize<span style=color:#719e07>();</span></code></pre></div></section><section id=pythoncode22 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>driver<span style=color:#719e07>.</span>maximize_window()</code></pre></div></section><section id=csharpcode22 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>driver.Manage().Window.Maximize();
</code></pre></div></section><section id=rubycode22 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>driver<span style=color:#719e07>.</span>manage<span style=color:#719e07>.</span>window<span style=color:#719e07>.</span>maximize</code></pre></div></section><section id=javascriptcode22 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>await driver.manage().<span style=color:#b58900>window</span>().maximize();
</code></pre></div></section><section id=kotlincode22 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>driver.manage().window().maximize()</code></pre></div></section></div></div><h3 id=最小化窗口>最小化窗口</h3><p>最小化当前浏览上下文的窗口.
这种命令的精准行为将作用于各个特定的窗口管理器.</p><p>最小化窗口通常将窗口隐藏在系统托盘中.</p><p><strong>注意: 此功能适用于Selenium 4以及更高版本.</strong></p><div class=tabset><input type=radio name=tabsetcode23 class=tabjava id=tab0code23 aria-controls=javacode23 onclick=handleClick(this); value=java checked>
<label for=tab0code23>Java</label>
<input type=radio name=tabsetcode23 class=tabpython id=tab1code23 aria-controls=pythoncode23 onclick=handleClick(this); value=python>
<label for=tab1code23>Python</label>
<input type=radio name=tabsetcode23 class=tabcs id=tab2code23 aria-controls=cscode23 onclick=handleClick(this); value=cs>
<label for=tab2code23>C#</label>
<input type=radio name=tabsetcode23 class=tabruby id=tab3code23 aria-controls=rubycode23 onclick=handleClick(this); value=ruby>
<label for=tab3code23>Ruby</label>
<input type=radio name=tabsetcode23 class=tabjavascript id=tab4code23 aria-controls=javascriptcode23 onclick=handleClick(this); value=javascript>
<label for=tab4code23>JavaScript</label>
<input type=radio name=tabsetcode23 class=tabkotlin id=tab5code23 aria-controls=kotlincode23 onclick=handleClick(this); value=kotlin>
<label for=tab5code23>Kotlin</label><div class=tab-panels><section id=javacode23 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>driver<span style=color:#719e07>.</span>manage<span style=color:#719e07>().</span>window<span style=color:#719e07>().</span>minimize<span style=color:#719e07>();</span></code></pre></div></section><section id=pythoncode23 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>driver<span style=color:#719e07>.</span>minimize_window()</code></pre></div></section><section id=csharpcode23 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>driver.Manage().Window.Minimize();
</code></pre></div></section><section id=rubycode23 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>driver<span style=color:#719e07>.</span>manage<span style=color:#719e07>.</span>window<span style=color:#719e07>.</span>minimize</code></pre></div></section><section id=javascriptcode23 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>await driver.manage().<span style=color:#b58900>window</span>().minimize();
</code></pre></div></section><section id=kotlincode23 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>driver.manage().window().minimize()</code></pre></div></section></div></div><h3 id=全屏窗口>全屏窗口</h3><p>填充整个屏幕，类似于在大多数浏览器中按下 F11。</p><div class=tabset><input type=radio name=tabsetcode24 class=tabjava id=tab0code24 aria-controls=javacode24 onclick=handleClick(this); value=java checked>
<label for=tab0code24>Java</label>
<input type=radio name=tabsetcode24 class=tabpython id=tab1code24 aria-controls=pythoncode24 onclick=handleClick(this); value=python>
<label for=tab1code24>Python</label>
<input type=radio name=tabsetcode24 class=tabcs id=tab2code24 aria-controls=cscode24 onclick=handleClick(this); value=cs>
<label for=tab2code24>C#</label>
<input type=radio name=tabsetcode24 class=tabruby id=tab3code24 aria-controls=rubycode24 onclick=handleClick(this); value=ruby>
<label for=tab3code24>Ruby</label>
<input type=radio name=tabsetcode24 class=tabjavascript id=tab4code24 aria-controls=javascriptcode24 onclick=handleClick(this); value=javascript>
<label for=tab4code24>JavaScript</label>
<input type=radio name=tabsetcode24 class=tabkotlin id=tab5code24 aria-controls=kotlincode24 onclick=handleClick(this); value=kotlin>
<label for=tab5code24>Kotlin</label><div class=tab-panels><section id=javacode24 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>driver<span style=color:#719e07>.</span>manage<span style=color:#719e07>().</span>window<span style=color:#719e07>().</span>fullscreen<span style=color:#719e07>();</span></code></pre></div></section><section id=pythoncode24 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>driver<span style=color:#719e07>.</span>fullscreen_window()</code></pre></div></section><section id=csharpcode24 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>driver.Manage().Window.FullScreen();
</code></pre></div></section><section id=rubycode24 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>driver<span style=color:#719e07>.</span>manage<span style=color:#719e07>.</span>window<span style=color:#719e07>.</span>full_screen</code></pre></div></section><section id=javascriptcode24 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>await driver.manage().<span style=color:#b58900>window</span>().fullscreen();
</code></pre></div></section><section id=kotlincode24 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>driver.manage().window().fullscreen()</code></pre></div></section></div></div><h3 id=屏幕截图>屏幕截图</h3><p>用于捕获当前浏览上下文的屏幕截图.
WebDriver端点
<a href=https://www.w3.org/TR/webdriver/#dfn-take-screenshot>屏幕截图</a>
返回以Base64格式编码的屏幕截图.</p><div class=tabset><input type=radio name=tabsetcode25 class=tabjava id=tab0code25 aria-controls=javacode25 onclick=handleClick(this); value=java checked>
<label for=tab0code25>Java</label>
<input type=radio name=tabsetcode25 class=tabpython id=tab1code25 aria-controls=pythoncode25 onclick=handleClick(this); value=python>
<label for=tab1code25>Python</label>
<input type=radio name=tabsetcode25 class=tabcs id=tab2code25 aria-controls=cscode25 onclick=handleClick(this); value=cs>
<label for=tab2code25>C#</label>
<input type=radio name=tabsetcode25 class=tabruby id=tab3code25 aria-controls=rubycode25 onclick=handleClick(this); value=ruby>
<label for=tab3code25>Ruby</label>
<input type=radio name=tabsetcode25 class=tabjavascript id=tab4code25 aria-controls=javascriptcode25 onclick=handleClick(this); value=javascript>
<label for=tab4code25>JavaScript</label>
<input type=radio name=tabsetcode25 class=tabkotlin id=tab5code25 aria-controls=kotlincode25 onclick=handleClick(this); value=kotlin>
<label for=tab5code25>Kotlin</label><div class=tab-panels><section id=javacode25 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>
<span style=color:#719e07>import</span> org.apache.commons.io.FileUtils<span style=color:#719e07>;</span>
<span style=color:#719e07>import</span> org.openqa.selenium.chrome.ChromeDriver<span style=color:#719e07>;</span>
<span style=color:#719e07>import</span> java.io.*<span style=color:#719e07>;</span>
<span style=color:#719e07>import</span> org.openqa.selenium.*<span style=color:#719e07>;</span>

<span style=color:#268bd2>public</span> <span style=color:#268bd2>class</span> <span style=color:#268bd2>SeleniumTakeScreenshot</span> <span style=color:#719e07>{</span>
<span style=color:#268bd2>public</span> <span style=color:#268bd2>static</span> <span style=color:#dc322f>void</span> <span style=color:#268bd2>main</span><span style=color:#719e07>(</span>String args<span style=color:#719e07>[])</span> <span style=color:#268bd2>throws</span> IOException <span style=color:#719e07>{</span>
WebDriver driver <span style=color:#719e07>=</span> <span style=color:#719e07>new</span> ChromeDriver<span style=color:#719e07>();</span>
driver<span style=color:#719e07>.</span>get<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;http://www.example.com&#34;</span><span style=color:#719e07>);</span>
File scrFile <span style=color:#719e07>=</span> <span style=color:#719e07>((</span>TakesScreenshot<span style=color:#719e07>)</span>driver<span style=color:#719e07>).</span>getScreenshotAs<span style=color:#719e07>(</span>OutputType<span style=color:#719e07>.</span>FILE<span style=color:#719e07>);</span>
FileUtils<span style=color:#719e07>.</span>copyFile<span style=color:#719e07>(</span>scrFile<span style=color:#719e07>,</span> <span style=color:#719e07>new</span> File<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;./image.png&#34;</span><span style=color:#719e07>));</span>
driver<span style=color:#719e07>.</span>quit<span style=color:#719e07>();</span>
<span style=color:#719e07>}</span>
<span style=color:#719e07>}</span>
</code></pre></div></section><section id=pythoncode25 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>
<span style=color:#719e07>from</span> selenium <span style=color:#719e07>import</span> webdriver

driver <span style=color:#719e07>=</span> webdriver<span style=color:#719e07>.</span>Chrome()

<span style=color:#586e75># Navigate to url</span>
driver<span style=color:#719e07>.</span>get(<span style=color:#2aa198>&#34;http://www.example.com&#34;</span>)

<span style=color:#586e75># Returns and base64 encoded string into image</span>
driver<span style=color:#719e07>.</span>save_screenshot(<span style=color:#2aa198>&#39;./image.png&#39;</span>)

driver<span style=color:#719e07>.</span>quit()
</code></pre></div></section><section id=csharpcode25 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>
<span style=color:#719e07>using</span> OpenQA.Selenium;
<span style=color:#719e07>using</span> OpenQA.Selenium.Chrome;
<span style=color:#719e07>using</span> OpenQA.Selenium.Support.UI;

    <span style=color:#dc322f>var</span> driver = <span style=color:#719e07>new</span> ChromeDriver();
    driver.Navigate().GoToUrl(<span style=color:#2aa198>&#34;http://www.example.com&#34;</span>);
    Screenshot screenshot = (driver <span style=color:#719e07>as</span> ITakesScreenshot).GetScreenshot();
    screenshot.SaveAsFile(<span style=color:#2aa198>&#34;screenshot.png&#34;</span>, ScreenshotImageFormat.Png); <span style=color:#586e75>// Format values are Bmp, Gif, Jpeg, Png, Tiff
</span></code></pre></div></section><section id=rubycode25 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>
<span style=color:#b58900>require</span> <span style=color:#2aa198>&#39;selenium-webdriver&#39;</span>
driver <span style=color:#719e07>=</span> <span style=color:#cb4b16>Selenium</span><span style=color:#719e07>::</span><span style=color:#cb4b16>WebDriver</span><span style=color:#719e07>.</span>for <span style=color:#2aa198>:chrome</span>

<span style=color:#719e07>begin</span>
driver<span style=color:#719e07>.</span>get <span style=color:#2aa198>&#39;https://example.com/&#39;</span>

<span style=color:#586e75># Takes and Stores the screenshot in specified path</span>
driver<span style=color:#719e07>.</span>save_screenshot(<span style=color:#2aa198>&#39;./image.png&#39;</span>)

<span style=color:#719e07>end</span>
</code></pre></div></section><section id=javascriptcode25 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>
<span style=color:#268bd2>let</span> {Builder} <span style=color:#719e07>=</span> require(<span style=color:#2aa198>&#39;selenium-webdriver&#39;</span>);
<span style=color:#268bd2>let</span> fs <span style=color:#719e07>=</span> require(<span style=color:#2aa198>&#39;fs&#39;</span>);

(async <span style=color:#268bd2>function</span> example() {
<span style=color:#268bd2>let</span> driver <span style=color:#719e07>=</span> await <span style=color:#719e07>new</span> Builder()
.forBrowser(<span style=color:#2aa198>&#39;chrome&#39;</span>)
.build();

    await driver.get(<span style=color:#2aa198>&#39;https://www.example.com&#39;</span>);
    <span style=color:#586e75>// Returns base64 encoded string
</span><span style=color:#586e75></span>    <span style=color:#268bd2>let</span> encodedString <span style=color:#719e07>=</span> await driver.takeScreenshot();
    await fs.writeFileSync(<span style=color:#2aa198>&#39;./image.png&#39;</span>, encodedString, <span style=color:#2aa198>&#39;base64&#39;</span>);
    await driver.quit();
}())
</code></pre></div></section><section id=kotlincode25 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>
<span style=color:#719e07>import</span> com.oracle.tools.packager.IOUtils.copyFile
<span style=color:#719e07>import</span> org.openqa.selenium.*
<span style=color:#719e07>import</span> org.openqa.selenium.chrome.ChromeDriver
<span style=color:#719e07>import</span> java.io.File

<span style=color:#719e07>fun</span> <span style=color:#268bd2>main</span>(){
<span style=color:#719e07>val</span> driver =  ChromeDriver()
driver.<span style=color:#719e07>get</span>(<span style=color:#2aa198>&#34;https://www.example.com&#34;</span>)
<span style=color:#719e07>val</span> scrFile = (driver <span style=color:#719e07>as</span> TakesScreenshot).getScreenshotAs&lt;File&gt;(OutputType.FILE)
copyFile(scrFile, File(<span style=color:#2aa198>&#34;./image.png&#34;</span>))
driver.quit()
}
</code></pre></div></section></div></div><h3 id=元素屏幕截图>元素屏幕截图</h3><p>用于捕获当前浏览上下文的元素的屏幕截图.
WebDriver端点
<a href=https://www.w3.org/TR/webdriver/#take-element-screenshot>屏幕截图</a>
返回以Base64格式编码的屏幕截图.</p><div class=tabset><input type=radio name=tabsetcode26 class=tabjava id=tab0code26 aria-controls=javacode26 onclick=handleClick(this); value=java checked>
<label for=tab0code26>Java</label>
<input type=radio name=tabsetcode26 class=tabpython id=tab1code26 aria-controls=pythoncode26 onclick=handleClick(this); value=python>
<label for=tab1code26>Python</label>
<input type=radio name=tabsetcode26 class=tabcs id=tab2code26 aria-controls=cscode26 onclick=handleClick(this); value=cs>
<label for=tab2code26>C#</label>
<input type=radio name=tabsetcode26 class=tabruby id=tab3code26 aria-controls=rubycode26 onclick=handleClick(this); value=ruby>
<label for=tab3code26>Ruby</label>
<input type=radio name=tabsetcode26 class=tabjavascript id=tab4code26 aria-controls=javascriptcode26 onclick=handleClick(this); value=javascript>
<label for=tab4code26>JavaScript</label>
<input type=radio name=tabsetcode26 class=tabkotlin id=tab5code26 aria-controls=kotlincode26 onclick=handleClick(this); value=kotlin>
<label for=tab5code26>Kotlin</label><div class=tab-panels><section id=javacode26 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>
<span style=color:#719e07>import</span> org.apache.commons.io.FileUtils<span style=color:#719e07>;</span>
<span style=color:#719e07>import</span> org.openqa.selenium.*<span style=color:#719e07>;</span>
<span style=color:#719e07>import</span> org.openqa.selenium.chrome.ChromeDriver<span style=color:#719e07>;</span>
<span style=color:#719e07>import</span> java.io.File<span style=color:#719e07>;</span>
<span style=color:#719e07>import</span> java.io.IOException<span style=color:#719e07>;</span>

<span style=color:#268bd2>public</span> <span style=color:#268bd2>class</span> <span style=color:#268bd2>SeleniumelementTakeScreenshot</span> <span style=color:#719e07>{</span>
<span style=color:#268bd2>public</span> <span style=color:#268bd2>static</span> <span style=color:#dc322f>void</span> <span style=color:#268bd2>main</span><span style=color:#719e07>(</span>String args<span style=color:#719e07>[])</span> <span style=color:#268bd2>throws</span> IOException <span style=color:#719e07>{</span>
WebDriver driver <span style=color:#719e07>=</span> <span style=color:#719e07>new</span> ChromeDriver<span style=color:#719e07>();</span>
driver<span style=color:#719e07>.</span>get<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;https://www.example.com&#34;</span><span style=color:#719e07>);</span>
WebElement element <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>findElement<span style=color:#719e07>(</span>By<span style=color:#719e07>.</span>cssSelector<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;h1&#34;</span><span style=color:#719e07>));</span>
File scrFile <span style=color:#719e07>=</span> element<span style=color:#719e07>.</span>getScreenshotAs<span style=color:#719e07>(</span>OutputType<span style=color:#719e07>.</span>FILE<span style=color:#719e07>);</span>
FileUtils<span style=color:#719e07>.</span>copyFile<span style=color:#719e07>(</span>scrFile<span style=color:#719e07>,</span> <span style=color:#719e07>new</span> File<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;./image.png&#34;</span><span style=color:#719e07>));</span>
driver<span style=color:#719e07>.</span>quit<span style=color:#719e07>();</span>
<span style=color:#719e07>}</span>
<span style=color:#719e07>}</span>
</code></pre></div></section><section id=pythoncode26 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>
<span style=color:#719e07>from</span> selenium <span style=color:#719e07>import</span> webdriver
<span style=color:#719e07>from</span> selenium.webdriver.common.by <span style=color:#719e07>import</span> By

driver <span style=color:#719e07>=</span> webdriver<span style=color:#719e07>.</span>Chrome()

<span style=color:#586e75># Navigate to url</span>
driver<span style=color:#719e07>.</span>get(<span style=color:#2aa198>&#34;http://www.example.com&#34;</span>)

ele <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>find_element(By<span style=color:#719e07>.</span>CSS_SELECTOR, <span style=color:#2aa198>&#39;h1&#39;</span>)

<span style=color:#586e75># Returns and base64 encoded string into image</span>
ele<span style=color:#719e07>.</span>screenshot(<span style=color:#2aa198>&#39;./image.png&#39;</span>)

driver<span style=color:#719e07>.</span>quit()
</code></pre></div></section><section id=csharpcode26 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>
<span style=color:#719e07>using</span> OpenQA.Selenium;
<span style=color:#719e07>using</span> OpenQA.Selenium.Chrome;
<span style=color:#719e07>using</span> OpenQA.Selenium.Support.UI;

    <span style=color:#586e75>// Webdriver
</span><span style=color:#586e75></span>    <span style=color:#dc322f>var</span> driver = <span style=color:#719e07>new</span> ChromeDriver();
    driver.Navigate().GoToUrl(<span style=color:#2aa198>&#34;http://www.example.com&#34;</span>);

    <span style=color:#586e75>// Fetch element using FindElement
</span><span style=color:#586e75></span>    <span style=color:#dc322f>var</span> webElement = driver.FindElement(By.CssSelector(<span style=color:#2aa198>&#34;h1&#34;</span>));

    <span style=color:#586e75>// Screenshot for the element
</span><span style=color:#586e75></span>    <span style=color:#dc322f>var</span> elementScreenshot = (webElement <span style=color:#719e07>as</span> ITakesScreenshot).GetScreenshot();
    elementScreenshot.SaveAsFile(<span style=color:#2aa198>&#34;screenshot_of_element.png&#34;</span>);
</code></pre></div></section><section id=rubycode26 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>
<span style=color:#586e75># Works with Selenium4-alpha7 Ruby bindings and above</span>
<span style=color:#b58900>require</span> <span style=color:#2aa198>&#39;selenium-webdriver&#39;</span>
driver <span style=color:#719e07>=</span> <span style=color:#cb4b16>Selenium</span><span style=color:#719e07>::</span><span style=color:#cb4b16>WebDriver</span><span style=color:#719e07>.</span>for <span style=color:#2aa198>:chrome</span>

<span style=color:#719e07>begin</span>
driver<span style=color:#719e07>.</span>get <span style=color:#2aa198>&#39;https://example.com/&#39;</span>
ele <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>find_element(<span style=color:#2aa198>:css</span>, <span style=color:#2aa198>&#39;h1&#39;</span>)

<span style=color:#586e75># Takes and Stores the element screenshot in specified path</span>
ele<span style=color:#719e07>.</span>save_screenshot(<span style=color:#2aa198>&#39;./image.jpg&#39;</span>)
<span style=color:#719e07>end</span>
</code></pre></div></section><section id=javascriptcode26 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>
<span style=color:#268bd2>const</span> {Builder, By} <span style=color:#719e07>=</span> require(<span style=color:#2aa198>&#39;selenium-webdriver&#39;</span>);
<span style=color:#268bd2>let</span> fs <span style=color:#719e07>=</span> require(<span style=color:#2aa198>&#39;fs&#39;</span>);

(async <span style=color:#268bd2>function</span> example() {
<span style=color:#268bd2>let</span> driver <span style=color:#719e07>=</span> await <span style=color:#719e07>new</span> Builder()
.forBrowser(<span style=color:#2aa198>&#39;chrome&#39;</span>)
.build();

await driver.get(<span style=color:#2aa198>&#39;https://www.example.com&#39;</span>);
<span style=color:#268bd2>let</span> ele <span style=color:#719e07>=</span> await driver.findElement(By.css(<span style=color:#2aa198>&#34;h1&#34;</span>));
<span style=color:#586e75>// Captures the element screenshot
</span><span style=color:#586e75></span><span style=color:#268bd2>let</span> encodedString <span style=color:#719e07>=</span> await ele.takeScreenshot(<span style=color:#cb4b16>true</span>);
await fs.writeFileSync(<span style=color:#2aa198>&#39;./image.png&#39;</span>, encodedString, <span style=color:#2aa198>&#39;base64&#39;</span>);
await driver.quit();
}())
</code></pre></div></section><section id=kotlincode26 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>
<span style=color:#719e07>import</span> org.apache.commons.io.FileUtils
<span style=color:#719e07>import</span> org.openqa.selenium.chrome.ChromeDriver
<span style=color:#719e07>import</span> org.openqa.selenium.*
<span style=color:#719e07>import</span> java.io.File

<span style=color:#719e07>fun</span> <span style=color:#268bd2>main</span>() {
<span style=color:#719e07>val</span> driver = ChromeDriver()
driver.<span style=color:#719e07>get</span>(<span style=color:#2aa198>&#34;https://www.example.com&#34;</span>)
<span style=color:#719e07>val</span> element = driver.findElement(By.cssSelector(<span style=color:#2aa198>&#34;h1&#34;</span>))
<span style=color:#719e07>val</span> scrFile: File = element.getScreenshotAs(OutputType.FILE)
FileUtils.copyFile(scrFile, File(<span style=color:#2aa198>&#34;./image.png&#34;</span>))
driver.quit()
}
</code></pre></div></section></div></div><h3 id=执行脚本>执行脚本</h3><p>在当前frame或者窗口的上下文中，执行JavaScript代码片段.</p><div class=tabset><input type=radio name=tabsetcode27 class=tabjava id=tab0code27 aria-controls=javacode27 onclick=handleClick(this); value=java checked>
<label for=tab0code27>Java</label>
<input type=radio name=tabsetcode27 class=tabpython id=tab1code27 aria-controls=pythoncode27 onclick=handleClick(this); value=python>
<label for=tab1code27>Python</label>
<input type=radio name=tabsetcode27 class=tabcs id=tab2code27 aria-controls=cscode27 onclick=handleClick(this); value=cs>
<label for=tab2code27>C#</label>
<input type=radio name=tabsetcode27 class=tabruby id=tab3code27 aria-controls=rubycode27 onclick=handleClick(this); value=ruby>
<label for=tab3code27>Ruby</label>
<input type=radio name=tabsetcode27 class=tabjavascript id=tab4code27 aria-controls=javascriptcode27 onclick=handleClick(this); value=javascript>
<label for=tab4code27>JavaScript</label>
<input type=radio name=tabsetcode27 class=tabkotlin id=tab5code27 aria-controls=kotlincode27 onclick=handleClick(this); value=kotlin>
<label for=tab5code27>Kotlin</label><div class=tab-panels><section id=javacode27 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>
<span style=color:#586e75>//Creating the JavascriptExecutor interface object by Type casting
</span><span style=color:#586e75></span>JavascriptExecutor js <span style=color:#719e07>=</span> <span style=color:#719e07>(</span>JavascriptExecutor<span style=color:#719e07>)</span>driver<span style=color:#719e07>;</span>
<span style=color:#586e75>//Button Element
</span><span style=color:#586e75></span>WebElement button <span style=color:#719e07>=</span>driver<span style=color:#719e07>.</span>findElement<span style=color:#719e07>(</span>By<span style=color:#719e07>.</span>name<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;btnLogin&#34;</span><span style=color:#719e07>));</span>
<span style=color:#586e75>//Executing JavaScript to click on element
</span><span style=color:#586e75></span>js<span style=color:#719e07>.</span>executeScript<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;arguments[0].click();&#34;</span><span style=color:#719e07>,</span> button<span style=color:#719e07>);</span>
<span style=color:#586e75>//Get return value from script
</span><span style=color:#586e75></span>String text <span style=color:#719e07>=</span> <span style=color:#719e07>(</span>String<span style=color:#719e07>)</span> js<span style=color:#719e07>.</span>executeScript<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;return arguments[0].innerText&#34;</span><span style=color:#719e07>,</span> button<span style=color:#719e07>);</span>
<span style=color:#586e75>//Executing JavaScript directly
</span><span style=color:#586e75></span>js<span style=color:#719e07>.</span>executeScript<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;console.log(&#39;hello world&#39;)&#34;</span><span style=color:#719e07>);</span>
</code></pre></div></section><section id=pythoncode27 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>
<span style=color:#586e75># Stores the header element</span>
header <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>find_element(By<span style=color:#719e07>.</span>CSS_SELECTOR, <span style=color:#2aa198>&#34;h1&#34;</span>)

<span style=color:#586e75># Executing JavaScript to capture innerText of header element</span>
driver<span style=color:#719e07>.</span>execute_script(<span style=color:#2aa198>&#39;return arguments[0].innerText&#39;</span>, header)
</code></pre></div></section><section id=csharpcode27 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>
<span style=color:#586e75>// code sample not available please raise a PR
</span></code></pre></div></section><section id=rubycode27 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>
<span style=color:#586e75># Stores the header element</span>
header <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>find_element(<span style=color:#2aa198>css</span>: <span style=color:#2aa198>&#39;h1&#39;</span>)

<span style=color:#586e75># Get return value from script</span>
result <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>execute_script(<span style=color:#2aa198>&#34;return arguments[0].innerText&#34;</span>, header)

<span style=color:#586e75># Executing JavaScript directly</span>
driver<span style=color:#719e07>.</span>execute_script(<span style=color:#2aa198>&#34;alert(&#39;hello world&#39;)&#34;</span>)
</code></pre></div></section><section id=javascriptcode27 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>
<span style=color:#586e75>// Stores the header element
</span><span style=color:#586e75></span><span style=color:#268bd2>let</span> header <span style=color:#719e07>=</span> await driver.findElement(By.css(<span style=color:#2aa198>&#39;h1&#39;</span>));

<span style=color:#586e75>// Executing JavaScript to capture innerText of header element
</span><span style=color:#586e75></span><span style=color:#268bd2>let</span> text <span style=color:#719e07>=</span> await driver.executeScript(<span style=color:#2aa198>&#39;return arguments[0].innerText&#39;</span>, header);
</code></pre></div></section><section id=kotlincode27 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>
<span style=color:#586e75>// Stores the header element
</span><span style=color:#586e75></span><span style=color:#719e07>val</span> header = driver.findElement(By.cssSelector(<span style=color:#2aa198>&#34;h1&#34;</span>))

<span style=color:#586e75>// Get return value from script
</span><span style=color:#586e75></span><span style=color:#719e07>val</span> result = driver.executeScript(<span style=color:#2aa198>&#34;return arguments[0].innerText&#34;</span>, header)

<span style=color:#586e75>// Executing JavaScript directly
</span><span style=color:#586e75></span>driver.executeScript(<span style=color:#2aa198>&#34;alert(&#39;hello world&#39;)&#34;</span>)
</code></pre></div></section></div></div><h3 id=打印页面>打印页面</h3><p>打印当前浏览器内的页面</p><p><em>注意: 此功能需要无头模式下的Chromium浏览器</em></p><div class=tabset><input type=radio name=tabsetcode28 class=tabjava id=tab0code28 aria-controls=javacode28 onclick=handleClick(this); value=java checked>
<label for=tab0code28>Java</label>
<input type=radio name=tabsetcode28 class=tabpython id=tab1code28 aria-controls=pythoncode28 onclick=handleClick(this); value=python>
<label for=tab1code28>Python</label>
<input type=radio name=tabsetcode28 class=tabcs id=tab2code28 aria-controls=cscode28 onclick=handleClick(this); value=cs>
<label for=tab2code28>C#</label>
<input type=radio name=tabsetcode28 class=tabruby id=tab3code28 aria-controls=rubycode28 onclick=handleClick(this); value=ruby>
<label for=tab3code28>Ruby</label>
<input type=radio name=tabsetcode28 class=tabjavascript id=tab4code28 aria-controls=javascriptcode28 onclick=handleClick(this); value=javascript>
<label for=tab4code28>JavaScript</label>
<input type=radio name=tabsetcode28 class=tabkotlin id=tab5code28 aria-controls=kotlincode28 onclick=handleClick(this); value=kotlin>
<label for=tab5code28>Kotlin</label><div class=tab-panels><section id=javacode28 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>
<span style=color:#719e07>import</span> org.openqa.selenium.print.PrintOptions<span style=color:#719e07>;</span>

    driver<span style=color:#719e07>.</span>get<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;https://www.selenium.dev&#34;</span><span style=color:#719e07>);</span>
    printer <span style=color:#719e07>=</span> <span style=color:#719e07>(</span>PrintsPage<span style=color:#719e07>)</span> driver<span style=color:#719e07>;</span>

    PrintOptions printOptions <span style=color:#719e07>=</span> <span style=color:#719e07>new</span> PrintOptions<span style=color:#719e07>();</span>
    printOptions<span style=color:#719e07>.</span>setPageRanges<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;1-2&#34;</span><span style=color:#719e07>);</span>

    Pdf pdf <span style=color:#719e07>=</span> printer<span style=color:#719e07>.</span>print<span style=color:#719e07>(</span>printOptions<span style=color:#719e07>);</span>
    String content <span style=color:#719e07>=</span> pdf<span style=color:#719e07>.</span>getContent<span style=color:#719e07>();</span>
</code></pre></div></section><section id=pythoncode28 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>
<span style=color:#719e07>from</span> selenium.webdriver.common.print_page_options <span style=color:#719e07>import</span> PrintOptions

    print_options <span style=color:#719e07>=</span> PrintOptions()
    print_options<span style=color:#719e07>.</span>page_ranges <span style=color:#719e07>=</span> [<span style=color:#2aa198>&#39;1-2&#39;</span>]

    driver<span style=color:#719e07>.</span>get(<span style=color:#2aa198>&#34;printPage.html&#34;</span>)

    base64code <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>print_page(print_options)
</code></pre></div></section><section id=csharpcode28 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>
<span style=color:#586e75>// code sample not available please raise a PR
</span></code></pre></div></section><section id=rubycode28 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>
driver<span style=color:#719e07>.</span>navigate_to <span style=color:#2aa198>&#39;https://www.selenium.dev&#39;</span>

    base64encodedContent <span style=color:#719e07>=</span> driver<span style=color:#719e07>.</span>print_page(<span style=color:#2aa198>orientation</span>: <span style=color:#2aa198>&#39;landscape&#39;</span>)
</code></pre></div></section><section id=javascriptcode28 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>
<span style=color:#268bd2>const</span> {Builder} <span style=color:#719e07>=</span> require(<span style=color:#2aa198>&#39;selenium-webdriver&#39;</span>);
<span style=color:#268bd2>const</span> chrome <span style=color:#719e07>=</span> require(<span style=color:#2aa198>&#39;selenium-webdriver/chrome&#39;</span>);
<span style=color:#268bd2>let</span> opts <span style=color:#719e07>=</span> <span style=color:#719e07>new</span> chrome.Options();
<span style=color:#268bd2>let</span> fs <span style=color:#719e07>=</span> require(<span style=color:#2aa198>&#39;fs&#39;</span>);
(async <span style=color:#268bd2>function</span> example() {
<span style=color:#268bd2>let</span> driver <span style=color:#719e07>=</span> <span style=color:#719e07>new</span> Builder()
.forBrowser(<span style=color:#2aa198>&#39;chrome&#39;</span>)
.setChromeOptions(opts.headless())
.build();
await driver.get(<span style=color:#2aa198>&#39;https://www.selenium.dev&#39;</span>);
<span style=color:#719e07>try</span> {
<span style=color:#268bd2>let</span> base64 <span style=color:#719e07>=</span> await driver.printPage({pageRanges<span style=color:#719e07>:</span>[<span style=color:#2aa198>&#34;1-2&#34;</span>]});
await fs.writeFileSync(<span style=color:#2aa198>&#39;./test.pdf&#39;</span>, base64, <span style=color:#2aa198>&#39;base64&#39;</span>);
} <span style=color:#719e07>catch</span> (e) {
console.log(e)
}
await driver.quit();
</code></pre></div></section><section id=kotlincode28 class=tab-panel><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin>
<span style=color:#586e75>// code sample not available please raise a PR
</span></code></pre></div></section></div></div><footer class=footline></footer><h5 class=meta-data><a href=https://www.selenium.dev/documentation/zh-cn/webdriver/browser_manipulation/>“操控浏览器”</a> was last updated on: 14 Jun 2021 09:57:45 -0500: <a href=https://github.com/SeleniumHQ/seleniumhq.github.io/commit/6c4e4fb25b1da7386d42c0dbe1f75366e989ef90>Overrid device mode example in Kotlin (#713)[deploy site] (6c4e4fb)</a></h5></div></div><div id=navigation><a class="nav nav-prev" href=https://www.selenium.dev/documentation/zh-cn/webdriver/locating_elements/ title=定位元素><i class="fa fa-chevron-left"></i></a><a class="nav nav-next" href=https://www.selenium.dev/documentation/zh-cn/webdriver/waits/ title=等待 style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=https://www.selenium.dev/documentation/js/clipboard.min.js?1623682698></script><script src=https://www.selenium.dev/documentation/js/perfect-scrollbar.min.js?1623682698></script><script src=https://www.selenium.dev/documentation/js/perfect-scrollbar.jquery.min.js?1623682698></script><script src=https://www.selenium.dev/documentation/js/jquery.sticky.js?1623682698></script><script src=https://www.selenium.dev/documentation/js/featherlight.min.js?1623682698></script><script src=https://www.selenium.dev/documentation/js/highlight.pack.js?1623682698></script><script>hljs.initHighlightingOnLoad();</script><script src=https://www.selenium.dev/documentation/js/modernizr.custom-3.6.0.js?1623682698></script><script src=https://www.selenium.dev/documentation/js/learn.js?1623682698></script><script src=https://www.selenium.dev/documentation/js/hugo-learn.js?1623682698></script><link href=https://www.selenium.dev/documentation/mermaid/mermaid.css?1623682698 rel=stylesheet><script src=https://www.selenium.dev/documentation/mermaid/mermaid.js?1623682698></script><script>mermaid.initialize({startOnLoad:true});</script><script>if(typeof(Storage)!=="undefined"){const activeLanguage=localStorage.getItem("active_language");if(activeLanguage){document.querySelectorAll(".tab"+activeLanguage).forEach(element=>{element.checked=true;});}}
function handleClick(languageRadio){if(typeof(Storage)!=="undefined"){localStorage.setItem("active_language",languageRadio.value);document.querySelectorAll(".tab"+languageRadio.value).forEach(element=>{element.checked=true;});}}</script></body></html>